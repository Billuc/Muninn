import{g as h,s as D,o as r,c as g,a as b,t as q,h as a,l as I,q as R,n as U,m as A,M as J,F as H,r as P,x as _,G as K,w as y,d as E,b as l,E as W,N as Q,v as X,D as Y}from"./entry.49f3b586.js";import{_ as Z}from"./Tag.5085e303.js";import{f as $,p as ee}from"./index.80596018.js";import{_ as j,a as z}from"./Dialog.vue.5d645579.js";import{F as x,u as M}from"./eventStore.db08204f.js";import{_ as G}from"./TagSelecter.vue.634bd37e.js";import{_ as te}from"./FABButton.vue.ce35e567.js";import{a as ne}from"./PageHeading.ad0b6c3e.js";import{i as ae}from"./isNaN.30d01d11.js";const se={class:"flex-grow"},le={class:"text-xs font-light leading-3"},oe={class:"focus:outline-none text-lg font-medium leading-5"},ce=h({__name:"CalendarEvent",props:{start:{},end:{},title:{},description:{},tag:{}},setup(m){const e=m,t=D(()=>{if(!e.start&&!e.end)return"Whole day";if(e.start&&!e.end)return $(e.start,"H:mm");if(e.start&&e.end)return`${$(e.start,"H:mm")} - ${$(e.end,"H:mm")}`});return(o,u)=>(r(),g("div",{class:U(("mergeClasses"in o?o.mergeClasses:a(A))("border-b","last-of-type:border-b-0","p-2","border-base-300","border-dashed","cursor-pointer","flex","items-center"))},[b("div",se,[b("p",le,q(a(t)),1),b("p",oe,q(e.title),1)]),e.tag?(r(),I(Z,{key:0,icon:e.tag.icon,color:e.tag.color},null,8,["icon","color"])):R("",!0)],2))}}),w=h({__name:"DateTimeSelector",props:{value:{},label:{},clearable:{type:Boolean}},emits:["input"],setup(m,{emit:e}){const t=m,{value:o}=J(t),u=D(()=>o.value?$(o.value,"yyyy-MM-dd'T'HH:mm"):"");function i(s){var v;const c=(v=s.target)==null?void 0:v.value,d=ee(c,"yyyy-MM-dd'T'HH:mm",new Date);ae(d.valueOf())||e("input",d)}const n=()=>e("input",null);return(s,c)=>(r(),I(ne,{label:t.label,type:"datetime-local",pattern:"\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}",clearable:t.clearable,value:a(u),onChange:i,onClear:n},null,8,["label","clearable","value"]))}}),re={class:"btn btn-xs"},ue=h({__name:"FrequencyVue",props:{frequency:{}},setup(m){return(e,t)=>(r(),g("div",re,q(e.frequency),1))}}),ie={class:"flex items-center gap-x-2 overflow-x-auto p-2"},de={class:"font-bold whitespace-nowrap"},L=h({__name:"FrequencySelecter",props:{frequency:{},label:{}},emits:["update:frequency"],setup(m,{emit:e}){const t=m,o=Object.values(x),u=i=>{e("update:frequency",i)};return(i,n)=>(r(),g("div",ie,[b("div",de,q(t.label??"Frequency :"),1),(r(!0),g(H,null,P(a(o),s=>(r(),I(ue,{frequency:s,onClick:()=>u(s),class:U({"outline outline-2 outline-offset-1 outline-neutral":t.frequency===s})},null,8,["frequency","onClick","class"]))),256))]))}}),ve={class:"form-control gap-y-2"},pe={class:"flex flex-nowrap gap-2 overflow-x-auto"},fe=h({__name:"EditEvent",props:{event:{}},emits:["close"],setup(m,{emit:e}){const t=m,o=M(),u=o.tagArray,i=D(()=>!!t.event),n=_(""),s=_(new Date),c=_(null),d=_(x.Once),v=_(-1),C=()=>e("close"),k=f=>n.value=f,F=f=>s.value=f,S=f=>c.value=f,T=f=>d.value=f,B=f=>v.value=f,p=()=>{t.event&&(o.editEvent(t.event.id,{title:n.value,frequency:d.value,start:s.value,end:c.value??void 0,tagId:v.value}),C())},N=()=>{t.event&&(o.removeEvent(t.event.id),C())};return K(()=>{t.event?(n.value=t.event.title,s.value=t.event.start,c.value=t.event.end??null,d.value=t.event.frequency,v.value=t.event.tagId):(n.value="",s.value=new Date,c.value=new Date,d.value=x.Once,v.value=-1)}),(f,be)=>{const O=W;return r(),I(z,{"is-opened":a(i),onClose:C},{title:y(()=>{var V;return[E("Update event '"+q((V=t.event)==null?void 0:V.title)+"'",1)]}),default:y(()=>[b("div",ve,[l(j,{label:"Event name",placeholder:"Enter name...",value:a(n),onInput:k},null,8,["value"]),b("div",pe,[l(w,{value:a(s),onInput:F,label:"Start of event"},null,8,["value"]),l(w,{value:a(c),onInput:S,label:"End of event",clearable:""},null,8,["value"])]),l(L,{frequency:a(d),"onUpdate:frequency":T},null,8,["frequency"]),l(G,{tags:a(u),selected:a(v),"onUpdate:selected":B},null,8,["tags","selected"])])]),actions:y(()=>[l(O,{class:"btn-error ml-2",onClick:N},{default:y(()=>[E("Delete")]),_:1}),l(O,{class:"btn-success ml-2",onClick:p},{default:y(()=>[E("Save")]),_:1})]),_:1},8,["is-opened"])}}}),_e={class:"menu"},me={key:1,class:"text-center font-light py-4"},ke=h({__name:"CalendarEvents",props:{day:{},tagFilter:{}},setup(m){const e=m,t=M(),o=_(null),u=D(()=>X(t.getEventsOfDay(e.day)).chain().filter(n=>(e.tagFilter??-1)<0||n.tagId===e.tagFilter).sortBy([n=>n.start.getHours(),n=>n.start.getMinutes()]).map(n=>({event:n,tag:t.tags.get(n.tagId)})).value()),i=n=>o.value=n;return(n,s)=>(r(),g("div",null,[a(u).length>0?(r(),g(H,{key:0},[b("ul",_e,[(r(!0),g(H,null,P(a(u),({event:c,tag:d})=>(r(),g("li",{key:"event-"+c.id},[l(ce,Q(c,{tag:d,onClick:v=>i(c),class:("mergeClasses"in n?n.mergeClasses:a(A))("px-6","rounded-box")}),null,16,["tag","onClick","class"])]))),128))]),l(fe,{event:a(o),onClose:s[0]||(s[0]=()=>i(null))},null,8,["event"])],64)):(r(),g("div",me,"No event for this day..."))]))}}),ge={class:"form-control gap-y-2"},ye={class:"flex flex-nowrap gap-2 overflow-x-auto"},Fe=h({__name:"CreateEvent",setup(m){const e=M(),t=_(!1),o=e.tagArray,u=_(""),i=_(new Date),n=_(null),s=_(x.Once),c=_(-1),d=()=>t.value=!0,v=()=>t.value=!1,C=p=>u.value=p,k=p=>i.value=p,F=p=>n.value=p,S=p=>s.value=p,T=p=>c.value=p,B=()=>{e.newEvent({title:u.value,frequency:s.value,start:i.value,end:n.value??void 0,tagId:c.value}),v()};return(p,N)=>{const f=W;return r(),g("div",null,[l(te,{icon:a(Y),class:"absolute -bottom-4 right-4 shadow-md btn-primary",onClick:d},null,8,["icon"]),l(z,{"is-opened":a(t),onClose:v},{title:y(()=>[E("Create a new event")]),default:y(()=>[b("div",ge,[l(j,{label:"Event name",placeholder:"Enter name...",value:a(u),onInput:C},null,8,["value"]),b("div",ye,[l(w,{value:a(i),onInput:k,label:"Start of event"},null,8,["value"]),l(w,{value:a(n),onInput:F,label:"End of event",clearable:""},null,8,["value"])]),l(L,{frequency:a(s),"onUpdate:frequency":S},null,8,["frequency"]),l(G,{tags:a(o),selected:a(c),"onUpdate:selected":T},null,8,["tags","selected"])])]),actions:y(()=>[l(f,{class:"btn-success",onClick:B},{default:y(()=>[E("Create")]),_:1})]),_:1},8,["is-opened"])])}}});export{ke as _,Fe as a};
