import{g as $,s as S,o as D,c as E,a as O,t as Y,h as u,l as j,q as ee,n as te,m as z,b as y,M as ne,L as ae,N as re,O as se,P as oe,x as h,G as le,w as b,d as q,K as _,E as G,F as R,r as ue,Q as ie,v as de,D as ce}from"./entry.30a63745.js";import{_ as ve}from"./Tag.3f804e8c.js";import{r as g,t as f,a as I,_ as fe,s as B,b as V,c as me,m as ge,d as pe,f as w,p as K}from"./index.f3feb017.js";import{_ as Q}from"./Dialog.vue.6aa04ba9.js";import{e as ye,u as U,F as k}from"./eventStore.243cdb41.js";import{a as Me}from"./index.6e1b1773.js";import{_ as he}from"./FABButton.vue.23e1d807.js";import{_ as _e}from"./InputAlt.vue.10a64f9a.js";import{a as De,b as Ie}from"./TagSelecter.vue.8d28b852.js";function be(a,e){g(2,arguments);var t=f(a),n=I(e);if(isNaN(n))return new Date(NaN);if(!n)return t;var r=t.getDate(),o=new Date(t.getTime());o.setMonth(t.getMonth()+n+1,0);var s=o.getDate();return r>=s?o:(t.setFullYear(o.getFullYear(),o.getMonth(),r),t)}function F(a,e){if(g(2,arguments),!e||fe(e)!=="object")return new Date(NaN);var t=e.years?I(e.years):0,n=e.months?I(e.months):0,r=e.weeks?I(e.weeks):0,o=e.days?I(e.days):0,s=e.hours?I(e.hours):0,l=e.minutes?I(e.minutes):0,c=e.seconds?I(e.seconds):0,m=f(a),p=n||t?be(m,n+t*12):m,i=o||r?Me(p,o+r*7):p,C=l+s*60,v=c+C*60,T=v*1e3,d=new Date(i.getTime()+T);return d}var Ee=864e5;function Ce(a,e){g(2,arguments);var t=B(a),n=B(e),r=t.getTime()-V(t),o=n.getTime()-V(n);return Math.round((r-o)/Ee)}var Te=6e4;function J(a,e){g(2,arguments);var t=I(e);return me(a,t*Te)}function N(a,e){g(2,arguments);var t=f(a),n=f(e),r=t.getTime()-n.getTime();return r<0?-1:r>0?1:r}function Ne(a,e){g(2,arguments);var t=f(a),n=f(e),r=t.getFullYear()-n.getFullYear(),o=t.getMonth()-n.getMonth();return r*12+o}function Fe(a,e){g(2,arguments);var t=f(a),n=f(e);return t.getFullYear()-n.getFullYear()}function W(a,e){var t=a.getFullYear()-e.getFullYear()||a.getMonth()-e.getMonth()||a.getDate()-e.getDate()||a.getHours()-e.getHours()||a.getMinutes()-e.getMinutes()||a.getSeconds()-e.getSeconds()||a.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function qe(a,e){g(2,arguments);var t=f(a),n=f(e),r=W(t,n),o=Math.abs(Ce(t,n));t.setDate(t.getDate()-r*o);var s=+(W(t,n)===-r),l=r*(o-s);return l===0?0:l}function A(a,e){return g(2,arguments),f(a).getTime()-f(e).getTime()}var P={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},we="trunc";function L(a){return a?P[a]:P[we]}function $e(a,e,t){g(2,arguments);var n=A(a,e)/ge;return L(t==null?void 0:t.roundingMethod)(n)}function Oe(a,e,t){g(2,arguments);var n=A(a,e)/pe;return L(t==null?void 0:t.roundingMethod)(n)}function ke(a){g(1,arguments);var e=f(a),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function He(a){g(1,arguments);var e=f(a);return ye(e).getTime()===ke(e).getTime()}function Ue(a,e){g(2,arguments);var t=f(a),n=f(e),r=N(t,n),o=Math.abs(Ne(t,n)),s;if(o<1)s=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-r*o);var l=N(t,n)===-r;He(f(a))&&o===1&&N(a,n)===1&&(l=!1),s=r*(o-Number(l))}return s===0?0:s}function Ye(a,e,t){g(2,arguments);var n=A(a,e)/1e3;return L(t==null?void 0:t.roundingMethod)(n)}function Se(a,e){g(2,arguments);var t=f(a),n=f(e),r=N(t,n),o=Math.abs(Fe(t,n));t.setFullYear(1584),n.setFullYear(1584);var s=N(t,n)===-r,l=r*(o-Number(s));return l===0?0:l}function Ae(a){g(1,arguments);var e=f(a.start),t=f(a.end);if(isNaN(e.getTime()))throw new RangeError("Start Date is invalid");if(isNaN(t.getTime()))throw new RangeError("End Date is invalid");var n={};n.years=Math.abs(Se(t,e));var r=N(t,e),o=F(e,{years:r*n.years});n.months=Math.abs(Ue(t,o));var s=F(o,{months:r*n.months});n.days=Math.abs(qe(t,s));var l=F(s,{days:r*n.days});n.hours=Math.abs($e(t,l));var c=F(l,{hours:r*n.hours});n.minutes=Math.abs(Oe(t,c));var m=F(c,{minutes:r*n.minutes});return n.seconds=Math.abs(Ye(t,m)),n}const Le={class:"flex-grow"},xe={class:"text-xs font-light leading-3"},Re={class:"focus:outline-none text-lg font-medium leading-5"},Be=$({__name:"CalendarEvent",props:{start:{},end:{},title:{},description:{},tag:{}},setup(a){const e=a,t=S(()=>{if(!e.start&&!e.end)return"Whole day";if(e.start&&!e.end)return w(e.start,"H:mm");if(e.start&&e.end)return`${w(e.start,"H:mm")} - ${w(e.end,"H:mm")}`});return(n,r)=>(D(),E("div",{class:te(("mergeClasses"in n?n.mergeClasses:u(z))("border-b","last-of-type:border-b-0","p-2","border-base-300","border-dashed","cursor-pointer","flex","items-center"))},[O("div",Le,[O("p",xe,Y(u(t)),1),O("p",Re,Y(e.title),1)]),e.tag?(D(),j(ve,{key:0,icon:e.tag.icon,color:e.tag.color},null,8,["icon","color"])):ee("",!0)],2))}});function Ve(a){return w(a,"yyyy-MM-dd")}function We(a){return w(a,"HH:mm")}function Pe(a,e){var n,r;const t=Ae({start:a,end:e});return`${("0"+((n=t.hours)==null?void 0:n.toString())).slice(-2)}:${("0"+((r=t.minutes)==null?void 0:r.toString())).slice(-2)}`}function H(a,e){return K(`${a}T${e}`,"yyyy-MM-dd'T'HH:mm",new Date)}function X(a){const e=K(a,"HH:mm",new Date);return 60*e.getHours()+e.getMinutes()}const je={class:"form-control gap-y-2"},Z=$({__name:"EventForm",props:{title:{},date:{},time:{},duration:{},frequency:{},tagId:{}},emits:["update:title","update:date","update:time","update:duration","update:frequency","update:tagId"],setup(a,{emit:e}){const t=a,n=U(),r=Object.entries(k).map(([i,C])=>({text:i,value:C})),o=i=>e("update:title",i),s=i=>e("update:date",i),l=i=>e("update:time",i),c=i=>e("update:duration",i),m=i=>e("update:frequency",i),p=i=>e("update:tagId",i);return(i,C)=>{const v=_e,T=Ie;return D(),E("div",je,[y(v,{label:"Event Name",placeholder:"Enter name...",value:t.title,icon:u(ne),onInput:o},null,8,["value","icon"]),y(v,{type:"date",label:"Event Date",placeholder:"Enter name...",value:i.date,icon:u(ae),onInput:s},null,8,["value","icon"]),y(v,{type:"time",label:"Event Time",placeholder:"Enter name...",value:i.time,icon:u(re),onInput:l},null,8,["value","icon"]),y(v,{type:"time",label:"Event Duration",placeholder:"Enter name...",value:i.duration,icon:u(se),onInput:c},null,8,["value","icon"]),y(T,{label:"Frequency",icon:u(oe),options:u(r),value:i.frequency,"onUpdate:value":m},null,8,["icon","options","value"]),y(De,{tags:u(n).tagArray,selected:t.tagId,"onUpdate:selected":p,clearable:""},null,8,["tags","selected"])])}}}),ze=$({__name:"EditEvent",props:{event:{}},emits:["close"],setup(a,{emit:e}){const t=a,n=U(),r=S(()=>!!t.event),o=h(""),s=h(""),l=h(""),c=h("01:00"),m=h(k.Once),p=h(-1),i=()=>e("close"),C=()=>{t.event&&(n.editEvent(t.event.id,{title:o.value,frequency:m.value,start:H(s.value,l.value),end:J(H(s.value,l.value),X(c.value)),tagId:p.value}),i())},v=()=>{t.event&&(n.removeEvent(t.event.id),i())};return le(()=>{t.event?(o.value=t.event.title,s.value=Ve(t.event.start),l.value=We(t.event.start),c.value=t.event.end?Pe(t.event.start,t.event.end):"00:00",m.value=t.event.frequency,p.value=t.event.tagId):(o.value="",s.value="",l.value="",c.value="01:00",m.value=k.Once,p.value=-1)}),(T,d)=>{const x=G;return D(),j(Q,{"is-opened":u(r),onClose:i},{title:b(()=>{var M;return[q("Update event '"+Y((M=t.event)==null?void 0:M.title)+"'",1)]}),default:b(()=>[y(Z,{title:u(o),"onUpdate:title":d[0]||(d[0]=M=>_(o)?o.value=M:null),date:u(s),"onUpdate:date":d[1]||(d[1]=M=>_(s)?s.value=M:null),time:u(l),"onUpdate:time":d[2]||(d[2]=M=>_(l)?l.value=M:null),duration:u(c),"onUpdate:duration":d[3]||(d[3]=M=>_(c)?c.value=M:null),frequency:u(m),"onUpdate:frequency":d[4]||(d[4]=M=>_(m)?m.value=M:null),"tag-id":u(p),"onUpdate:tagId":d[5]||(d[5]=M=>_(p)?p.value=M:null)},null,8,["title","date","time","duration","frequency","tag-id"])]),actions:b(()=>[y(x,{class:"btn-error ml-2",onClick:v},{default:b(()=>[q("Delete")]),_:1}),y(x,{class:"btn-success ml-2",onClick:C},{default:b(()=>[q("Save")]),_:1})]),_:1},8,["is-opened"])}}}),Ge={class:"menu"},Ke={key:1,class:"text-center font-light py-4"},st=$({__name:"CalendarEvents",props:{day:{},tagFilter:{}},setup(a){const e=a,t=U(),n=h(null),r=S(()=>de(t.getEventsOfDay(e.day)).chain().filter(s=>(e.tagFilter??-1)<0||s.tagId===e.tagFilter).sortBy([s=>s.start.getHours(),s=>s.start.getMinutes()]).map(s=>({event:s,tag:t.tags.get(s.tagId)})).value()),o=s=>n.value=s;return(s,l)=>(D(),E("div",null,[u(r).length>0?(D(),E(R,{key:0},[O("ul",Ge,[(D(!0),E(R,null,ue(u(r),({event:c,tag:m})=>(D(),E("li",{key:"event-"+c.id},[y(Be,ie(c,{tag:m,onClick:p=>o(c),class:("mergeClasses"in s?s.mergeClasses:u(z))("px-6","rounded-box")}),null,16,["tag","onClick","class"])]))),128))]),y(ze,{event:u(n),onClose:l[0]||(l[0]=()=>o(null))},null,8,["event"])],64)):(D(),E("div",Ke,"No event for this day..."))]))}}),ot=$({__name:"CreateEvent",setup(a){const e=U(),t=h(!1),n=h(""),r=h(""),o=h(""),s=h("01:00"),l=h(k.Once),c=h(-1),m=()=>t.value=!0,p=()=>t.value=!1,i=()=>{e.newEvent({title:n.value,frequency:l.value,start:H(r.value,o.value),end:J(H(r.value,o.value),X(s.value)),tagId:c.value}),p()};return(C,v)=>{const T=G;return D(),E("div",null,[y(he,{icon:u(ce),class:"absolute -bottom-4 right-4 shadow-md btn-primary",onClick:m},null,8,["icon"]),y(Q,{"is-opened":u(t),onClose:p},{title:b(()=>[q("Create a new event")]),default:b(()=>[y(Z,{title:u(n),"onUpdate:title":v[0]||(v[0]=d=>_(n)?n.value=d:null),date:u(r),"onUpdate:date":v[1]||(v[1]=d=>_(r)?r.value=d:null),time:u(o),"onUpdate:time":v[2]||(v[2]=d=>_(o)?o.value=d:null),duration:u(s),"onUpdate:duration":v[3]||(v[3]=d=>_(s)?s.value=d:null),frequency:u(l),"onUpdate:frequency":v[4]||(v[4]=d=>_(l)?l.value=d:null),"tag-id":u(c),"onUpdate:tagId":v[5]||(v[5]=d=>_(c)?c.value=d:null)},null,8,["title","date","time","duration","frequency","tag-id"])]),actions:b(()=>[y(T,{class:"btn-success",onClick:i},{default:b(()=>[q("Create")]),_:1})]),_:1},8,["is-opened"])])}}});export{st as _,be as a,ot as b};
