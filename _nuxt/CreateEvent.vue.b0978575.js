import{g as H,l as A,o as C,c as N,a as q,t as Y,h as u,q as z,O as ee,n as te,m as P,b as y,J as ne,T as ae,U as re,V as se,W as oe,x as _,N as le,w as E,d as O,B as D,M as J,F as x,r as ue,X as ie,y as de,v as ce,L as ve}from"./entry.fba0ea98.js";import{_ as fe,a as me}from"./SelectAlt.vue.88259c7d.js";import{r as m,t as c,a as b,_ as ge,s as B,b as V,c as pe,m as ye,d as Me,f as w,p as X}from"./index.f3feb017.js";import{a as he,b as G}from"./InputAlt.vue.c568be83.js";import{e as _e,u as S,F as k}from"./eventStore.737d8aa7.js";import{a as De}from"./index.6e1b1773.js";import{_ as Ie}from"./FABButton.vue.6f7ad212.js";import{_ as be}from"./TagSelecter.vue.e69c76ff.js";function Ee(a,e){m(2,arguments);var t=c(a),n=b(e);if(isNaN(n))return new Date(NaN);if(!n)return t;var r=t.getDate(),o=new Date(t.getTime());o.setMonth(t.getMonth()+n+1,0);var s=o.getDate();return r>=s?o:(t.setFullYear(o.getFullYear(),o.getMonth(),r),t)}function $(a,e){if(m(2,arguments),!e||ge(e)!=="object")return new Date(NaN);var t=e.years?b(e.years):0,n=e.months?b(e.months):0,r=e.weeks?b(e.weeks):0,o=e.days?b(e.days):0,s=e.hours?b(e.hours):0,l=e.minutes?b(e.minutes):0,d=e.seconds?b(e.seconds):0,v=c(a),p=n||t?Ee(v,n+t*12):v,i=o||r?De(p,o+r*7):p,T=l+s*60,I=d+T*60,f=I*1e3,g=new Date(i.getTime()+f);return g}var Ce=864e5;function Te(a,e){m(2,arguments);var t=B(a),n=B(e),r=t.getTime()-V(t),o=n.getTime()-V(n);return Math.round((r-o)/Ce)}var Ne=6e4;function K(a,e){m(2,arguments);var t=b(e);return pe(a,t*Ne)}function F(a,e){m(2,arguments);var t=c(a),n=c(e),r=t.getTime()-n.getTime();return r<0?-1:r>0?1:r}function Fe(a,e){m(2,arguments);var t=c(a),n=c(e),r=t.getFullYear()-n.getFullYear(),o=t.getMonth()-n.getMonth();return r*12+o}function $e(a,e){m(2,arguments);var t=c(a),n=c(e);return t.getFullYear()-n.getFullYear()}function W(a,e){var t=a.getFullYear()-e.getFullYear()||a.getMonth()-e.getMonth()||a.getDate()-e.getDate()||a.getHours()-e.getHours()||a.getMinutes()-e.getMinutes()||a.getSeconds()-e.getSeconds()||a.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function qe(a,e){m(2,arguments);var t=c(a),n=c(e),r=W(t,n),o=Math.abs(Te(t,n));t.setDate(t.getDate()-r*o);var s=+(W(t,n)===-r),l=r*(o-s);return l===0?0:l}function L(a,e){return m(2,arguments),c(a).getTime()-c(e).getTime()}var j={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},Oe="trunc";function R(a){return a?j[a]:j[Oe]}function we(a,e,t){m(2,arguments);var n=L(a,e)/ye;return R(t==null?void 0:t.roundingMethod)(n)}function ke(a,e,t){m(2,arguments);var n=L(a,e)/Me;return R(t==null?void 0:t.roundingMethod)(n)}function He(a){m(1,arguments);var e=c(a),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function Ue(a){m(1,arguments);var e=c(a);return _e(e).getTime()===He(e).getTime()}function Se(a,e){m(2,arguments);var t=c(a),n=c(e),r=F(t,n),o=Math.abs(Fe(t,n)),s;if(o<1)s=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-r*o);var l=F(t,n)===-r;Ue(c(a))&&o===1&&F(a,n)===1&&(l=!1),s=r*(o-Number(l))}return s===0?0:s}function Ye(a,e,t){m(2,arguments);var n=L(a,e)/1e3;return R(t==null?void 0:t.roundingMethod)(n)}function Ae(a,e){m(2,arguments);var t=c(a),n=c(e),r=F(t,n),o=Math.abs($e(t,n));t.setFullYear(1584),n.setFullYear(1584);var s=F(t,n)===-r,l=r*(o-Number(s));return l===0?0:l}function Le(a){m(1,arguments);var e=c(a.start),t=c(a.end);if(isNaN(e.getTime()))throw new RangeError("Start Date is invalid");if(isNaN(t.getTime()))throw new RangeError("End Date is invalid");var n={};n.years=Math.abs(Ae(t,e));var r=F(t,e),o=$(e,{years:r*n.years});n.months=Math.abs(Se(t,o));var s=$(o,{months:r*n.months});n.days=Math.abs(qe(t,s));var l=$(s,{days:r*n.days});n.hours=Math.abs(we(t,l));var d=$(l,{hours:r*n.hours});n.minutes=Math.abs(ke(t,d));var v=$(d,{minutes:r*n.minutes});return n.seconds=Math.abs(Ye(t,v)),n}const Re={class:"flex-grow"},xe={class:"text-xs font-light leading-3"},Be={class:"focus:outline-none text-lg font-medium leading-5"},Ve=H({__name:"CalendarEvent",props:{start:{},end:{},title:{},description:{},tag:{}},setup(a){const e=a,t=A(()=>{if(!e.start&&!e.end)return"Whole day";if(e.start&&!e.end)return w(e.start,"H:mm");if(e.start&&e.end)return`${w(e.start,"H:mm")} - ${w(e.end,"H:mm")}`});return(n,r)=>(C(),N("div",{class:te(("mergeClasses"in n?n.mergeClasses:u(P))("border-b","last-of-type:border-b-0","p-2","border-base-300","border-dashed","cursor-pointer","flex","items-center"))},[q("div",Re,[q("p",xe,Y(u(t)),1),q("p",Be,Y(e.title),1)]),e.tag?(C(),z(fe,{key:0,icon:e.tag.icon,color:e.tag.color},null,8,["icon","color"])):ee("",!0)],2))}});function We(a){return w(a,"yyyy-MM-dd")}function je(a){return w(a,"HH:mm")}function ze(a,e){var n,r;const t=Le({start:a,end:e});return`${("0"+((n=t.hours)==null?void 0:n.toString())).slice(-2)}:${("0"+((r=t.minutes)==null?void 0:r.toString())).slice(-2)}`}function U(a,e){return X(`${a}T${e}`,"yyyy-MM-dd'T'HH:mm",new Date)}function Q(a){const e=X(a,"HH:mm",new Date);return 60*e.getHours()+e.getMinutes()}const Pe={class:"form-control gap-y-2"},Z=H({__name:"EventForm",props:{title:{},date:{},time:{},duration:{},frequency:{},tagId:{}},emits:["update:title","update:date","update:time","update:duration","update:frequency","update:tagId"],setup(a,{emit:e}){const t=a,n=S(),r=Object.entries(k).map(([i,T])=>({text:i,value:T})),o=i=>e("update:title",i),s=i=>e("update:date",i),l=i=>e("update:time",i),d=i=>e("update:duration",i),v=i=>e("update:frequency",i),p=i=>e("update:tagId",i);return(i,T)=>{const I=he,f=me;return C(),N("div",Pe,[y(I,{label:"Event Name",placeholder:"Enter name...",value:t.title,icon:u(ne),onInput:o},null,8,["value","icon"]),y(I,{type:"date",label:"Event Date",placeholder:"Enter name...",value:i.date,icon:u(ae),onInput:s},null,8,["value","icon"]),y(I,{type:"time",label:"Event Time",placeholder:"Enter name...",value:i.time,icon:u(re),onInput:l},null,8,["value","icon"]),y(I,{type:"time",label:"Event Duration",placeholder:"Enter name...",value:i.duration,icon:u(se),onInput:d},null,8,["value","icon"]),y(f,{label:"Frequency",icon:u(oe),options:u(r),value:i.frequency,"onUpdate:value":v},null,8,["icon","options","value"]),y(be,{tags:u(n).tagArray,selected:t.tagId,"onUpdate:selected":p,clearable:""},null,8,["tags","selected"])])}}}),Je=H({__name:"EditEvent",props:{event:{}},emits:["close"],setup(a,{emit:e}){const t=a,n=S(),r=A(()=>!!t.event),o=_(""),s=_(""),l=_(""),d=_("01:00"),v=_(k.Once),p=_(-1),i=()=>e("close"),T=()=>{t.event&&(n.editEvent(t.event.id,{title:o.value,frequency:v.value,start:U(s.value,l.value),end:K(U(s.value,l.value),Q(d.value)),tagId:p.value}),i())},I=()=>{t.event&&(n.removeEvent(t.event.id),i())};return le(()=>{t.event?(o.value=t.event.title,s.value=We(t.event.start),l.value=je(t.event.start),d.value=t.event.end?ze(t.event.start,t.event.end):"00:00",v.value=t.event.frequency,p.value=t.event.tagId):(o.value="",s.value="",l.value="",d.value="01:00",v.value=k.Once,p.value=-1)}),(f,g)=>{const M=J;return C(),z(G,{"is-opened":u(r),onClose:i},{title:E(()=>{var h;return[O("Update event '"+Y((h=t.event)==null?void 0:h.title)+"'",1)]}),default:E(()=>[y(Z,{title:u(o),"onUpdate:title":g[0]||(g[0]=h=>D(o)?o.value=h:null),date:u(s),"onUpdate:date":g[1]||(g[1]=h=>D(s)?s.value=h:null),time:u(l),"onUpdate:time":g[2]||(g[2]=h=>D(l)?l.value=h:null),duration:u(d),"onUpdate:duration":g[3]||(g[3]=h=>D(d)?d.value=h:null),frequency:u(v),"onUpdate:frequency":g[4]||(g[4]=h=>D(v)?v.value=h:null),"tag-id":u(p),"onUpdate:tagId":g[5]||(g[5]=h=>D(p)?p.value=h:null)},null,8,["title","date","time","duration","frequency","tag-id"])]),actions:E(()=>[y(M,{class:"btn-error ml-2",onClick:I},{default:E(()=>[O("Delete")]),_:1}),y(M,{class:"btn-success ml-2",onClick:T},{default:E(()=>[O("Save")]),_:1})]),_:1},8,["is-opened"])}}}),Xe={class:"menu"},Ge=q("div",{class:"text-center font-light py-4"},"No event for this day...",-1),st=H({__name:"CalendarEvents",props:{day:{},tagFilter:{}},setup(a){const e=a,t=S(),n=_(null),r=A(()=>ce(t.getEventsOfDay(e.day)).chain().filter(s=>(e.tagFilter??-1)<0||s.tagId===e.tagFilter).sortBy([s=>s.start.getHours(),s=>s.start.getMinutes()]).map(s=>({event:s,tag:t.tags.get(s.tagId)})).value()),o=s=>n.value=s;return(s,l)=>(C(),N("div",null,[u(r).length>0?(C(),N(x,{key:0},[q("ul",Xe,[(C(!0),N(x,null,ue(u(r),({event:d,tag:v})=>(C(),N("li",{key:"event-"+d.id},[y(Ve,ie(d,{tag:v,onClick:p=>o(d),class:("mergeClasses"in s?s.mergeClasses:u(P))("px-6","rounded-box")}),null,16,["tag","onClick","class"])]))),128))]),y(Je,{event:u(n),onClose:l[0]||(l[0]=()=>o(null))},null,8,["event"])],64)):de(s.$slots,"no-event",{key:1},()=>[Ge])]))}}),ot=H({__name:"CreateEvent",setup(a){const e=S(),t=_(!1),n=_(""),r=_(""),o=_(""),s=_("01:00"),l=_(k.Once),d=_(-1),v=()=>t.value=!0,p=()=>t.value=!1,i=()=>{e.newEvent({title:n.value,frequency:l.value,start:U(r.value,o.value),end:K(U(r.value,o.value),Q(s.value)),tagId:d.value}),p(),T()},T=()=>{n.value="",r.value="",o.value="",s.value="01:00",l.value=k.Once,d.value=-1};return(I,f)=>{const g=J;return C(),N("div",null,[y(Ie,{icon:u(ve),class:"-bottom-4 right-4",onClick:v},null,8,["icon"]),y(G,{"is-opened":u(t),onClose:p},{title:E(()=>[O("Create a new event")]),default:E(()=>[y(Z,{title:u(n),"onUpdate:title":f[0]||(f[0]=M=>D(n)?n.value=M:null),date:u(r),"onUpdate:date":f[1]||(f[1]=M=>D(r)?r.value=M:null),time:u(o),"onUpdate:time":f[2]||(f[2]=M=>D(o)?o.value=M:null),duration:u(s),"onUpdate:duration":f[3]||(f[3]=M=>D(s)?s.value=M:null),frequency:u(l),"onUpdate:frequency":f[4]||(f[4]=M=>D(l)?l.value=M:null),"tag-id":u(d),"onUpdate:tagId":f[5]||(f[5]=M=>D(d)?d.value=M:null)},null,8,["title","date","time","duration","frequency","tag-id"])]),actions:E(()=>[y(g,{class:"btn-success",onClick:i},{default:E(()=>[O("Create")]),_:1})]),_:1},8,["is-opened"])])}}});export{st as _,Ee as a,ot as b};
