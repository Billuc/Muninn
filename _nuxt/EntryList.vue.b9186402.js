import{$ as g,g as p,o as c,c as d,b as l,j as i,y as S,A as v,r as E,O as $,x as k,a as b,a2 as h,v as C,K,n as B,m as J,h as M,M as A,N,i as j}from"./entry.0233ebe9.js";import{v as D}from"./v4.4a60fe23.js";import{f as R}from"./index.b79af48e.js";import{_ as x}from"./MultilineInput.vue.09ed4b83.js";const m=s=>R(s,"yyyy-MM-dd"),_=g("journal",{state:()=>({entries:new Map}),actions:{getEntries(s){var e;return[...((e=this.entries.get(m(s)))==null?void 0:e.values())??[]].map(t=>({date:new Date(t.date),id:t.id,text:t.text}))},newEntry(s,e){const t=m(s);this.entries.has(t)||this.entries.set(t,new Map);const n={date:t,id:D(),text:e};this.entries.get(t).set(n.id,n)},editEntry(s,e,t){const n=m(s);if(!this.entries.has(n))throw new Error(`[Journal] Key ${n} not found`);const r=this.entries.get(n);if(!r.has(e))throw new Error(`[Journal] Entry with ID ${e} not found`);r.set(e,{date:n,id:e,text:t})},removeEntry(s,e){const t=m(s);if(!this.entries.has(t))throw new Error(`[Journal] Key ${t} not found`);if(!this.entries.get(t).delete(e))throw new Error(`[Journal] Entry with ID ${e} not found`)}}}),T={class:"flex flex-nowrap"},U=p({__name:"EntryActions",emits:["remove"],setup(s,{emit:e}){const t=()=>e("remove");return(n,r)=>{const o=v;return c(),d("div",T,[l(o,{icon:i(S),class:"btn-circle !btn-xs",onClick:t},null,8,["icon"])])}}}),I={class:"m-0 marker:text-neutral"},L={class:"flex flex-nowrap"},P=p({__name:"Entry",props:{entry:{},id:{},date:{}},setup(s){const e=s,t=E(e.entry),n=_(),r=$(),o=y=>{t.value=y,r.setSyncStatus(h.Syncing),f()},a=()=>n.removeEntry(e.date,e.id),u=()=>{t.value?n.editEntry(e.date,e.id,t.value):n.removeEntry(e.date,e.id),r.setSyncStatus(h.Synced)},f=k.debounce(u,2e3),w=()=>{f.cancel(),u()};return(y,z)=>(c(),d("li",I,[b("div",L,[l(x,{value:i(t),placeholder:"Write here...",class:"w-full","detect-enter":"",onEnter:w,"onUpdate:value":o},null,8,["value"]),l(U,{onRemove:a})])]))}}),V=p({__name:"AddEntry",props:{date:{}},setup(s){const e=s,t=_(),n=E(""),r=()=>{n.value.trim()&&t.newEntry(e.date,n.value.trim()),n.value=""};return(o,a)=>(c(),d("li",{class:B(("mergeClasses"in o?o.mergeClasses:i(J))("m-0","marker:text-base-300","flex","flex-nowrap","items-center","gap-x-2"))},[l(x,{value:i(n),"onUpdate:value":a[0]||(a[0]=u=>C(n)?n.value=u:null),placeholder:"Write here...",class:"w-full","detect-enter":"",onEnter:r},null,8,["value"]),l(v,{icon:i(K),class:"btn-circle !btn-xs",onClick:r},null,8,["icon"])],2))}}),W={class:"list-disc pl-8"},H=p({__name:"EntryList",props:{date:{}},setup(s){const e=s,t=_(),n=M(()=>t.getEntries(e.date));return(r,o)=>(c(),d("ul",W,[(c(!0),d(A,null,N(i(n),a=>(c(),j(P,{entry:a.text,id:a.id,date:a.date,key:`entry-${a.id}`},null,8,["entry","id","date"]))),128)),l(V,{date:e.date},null,8,["date"])]))}});export{H as _};
