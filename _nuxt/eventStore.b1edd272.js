import{d as y}from"./PageHeading.e201258d.js";import{A as v}from"./entry.57980362.js";import{r as h,t as o,f as w,p as E}from"./index.1dfe98c4.js";function D(t){h(1,arguments);var e=o(t);return e.setHours(0,0,0,0),e}function p(t){h(1,arguments);var e=o(t);return e.setHours(23,59,59,999),e}function l(t,e){var s;h(1,arguments);var a=t||{},r=o(a.start),c=o(a.end),f=c.getTime();if(!(r.getTime()<=f))throw new RangeError("Invalid interval");var m=[],n=r;n.setHours(0,0,0,0);var g=Number((s=e==null?void 0:e.step)!==null&&s!==void 0?s:1);if(g<1||isNaN(g))throw new RangeError("`options.step` must be a number greater than 1");for(;n.getTime()<=f;)m.push(o(n)),n.setDate(n.getDate()+g),n.setHours(0,0,0,0);return m}var i=(t=>(t.Once="once",t.Daily="daily",t.Weekly="weekly",t.Monthly="monthly",t.Yearly="yearly",t))(i||{});const d=t=>w(t,"yyyy-MM-dd HH:mm"),u=t=>E(t,"yyyy-MM-dd HH:mm",new Date),T=(t,e)=>{const s=u(t.start),a=u(t.end??t.start);if(e<D(s))return!1;switch(t.frequency){case i.Once:return p(a)>=e;case i.Daily:return!0;case i.Weekly:return l({start:s,end:a}).some(r=>r.getDay()===e.getDay());case i.Monthly:return l({start:s,end:a}).some(r=>r.getDate()===e.getDate());case i.Yearly:return l({start:s,end:a}).some(r=>r.getDate()===e.getDate()&&r.getMonth()===e.getMonth());default:return!1}},H=y("events",{state:()=>({events:new Map,tags:new Map,nextEventId:0,nextTagId:0}),getters:{tagArray:t=>[...t.tags.values()]},actions:{getEventsOfDay(t){return[...this.events.values()].filter(e=>T(e,t)).map(e=>({id:e.id,frequency:e.frequency,start:u(e.start),title:e.title,end:e.end?u(e.end):void 0,tagId:e.tagId}))},newEvent(t){const e={id:this.nextEventId,title:t.title,frequency:t.frequency,start:d(t.start),end:t.end?d(t.end):void 0,tagId:t.tagId};this.events.set(this.nextEventId,e),this.nextEventId++},editEvent(t,e){const s=this.events.get(t);if(!s)throw new Error(`[Events] Key ${t} not found`);const a={id:t,title:e.title??s.title,frequency:e.frequency??s.frequency,start:e.start?d(e.start):s.start,end:e.end?d(e.end):s.end,tagId:e.tagId??s.tagId};this.events.set(t,a)},removeEvent(t){if(!this.events.delete(t))throw new Error(`[Events] Key ${t} not found`)},newTag(t,e,s){if(v.some([...this.tags.values()],a=>a.color===e))throw new Error(`[Events] Tag with color ${e} already exists`);this.tags.set(this.nextTagId,{id:this.nextTagId,title:t,color:e,icon:s}),this.nextTagId++},removeTag(t){this.tags.delete(t)},editTag(t,e,s,a){if(!this.tags.has(t))throw new Error(`[Events] Tag with ID ${t} not found`);if(v.some([...this.tags.values()],r=>r.id!==t&&r.color===s))throw new Error(`[Events] Tag with color ${s} already exists`);this.tags.set(t,{id:t,color:s,title:e,icon:a})}}});export{i as F,l as e,D as s,H as u};
