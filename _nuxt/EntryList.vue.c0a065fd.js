import{X as g,g as p,o as c,c as d,b as l,j as i,Y as S,K as v,r as E,N as $,x as k,a as b,Z as h,z as C,q as J,J as K,s as B,h as M,F as N,n as j,i as A}from"./entry.ff782d29.js";import{v as D}from"./PageHeading.d4020c78.js";import{f as R}from"./index.504780f4.js";import{_ as x}from"./MultilineInput.vue.dd73ffca.js";const m=s=>R(s,"yyyy-MM-dd"),_=g("journal",{state:()=>({entries:new Map}),actions:{getEntries(s){var e;return[...((e=this.entries.get(m(s)))==null?void 0:e.values())??[]].map(t=>({date:new Date(t.date),id:t.id,text:t.text}))},newEntry(s,e){const t=m(s);this.entries.has(t)||this.entries.set(t,new Map);const n={date:t,id:D(),text:e};this.entries.get(t).set(n.id,n)},editEntry(s,e,t){const n=m(s);if(!this.entries.has(n))throw new Error(`[Journal] Key ${n} not found`);const r=this.entries.get(n);if(!r.has(e))throw new Error(`[Journal] Entry with ID ${e} not found`);r.set(e,{date:n,id:e,text:t})},removeEntry(s,e){const t=m(s);if(!this.entries.has(t))throw new Error(`[Journal] Key ${t} not found`);if(!this.entries.get(t).delete(e))throw new Error(`[Journal] Entry with ID ${e} not found`)}}}),T={class:"flex flex-nowrap"},U=p({__name:"EntryActions",emits:["remove"],setup(s,{emit:e}){const t=()=>e("remove");return(n,r)=>{const o=v;return c(),d("div",T,[l(o,{icon:i(S),class:"btn-circle !btn-xs",onClick:t},null,8,["icon"])])}}}),z={class:"m-0 marker:text-neutral"},F={class:"flex flex-nowrap"},I=p({__name:"Entry",props:{entry:{},id:{},date:{}},setup(s){const e=s,t=E(e.entry),n=_(),r=$(),o=y=>{t.value=y,r.setSyncStatus(h.Syncing),f()},a=()=>n.removeEntry(e.date,e.id),u=()=>{t.value?n.editEntry(e.date,e.id,t.value):n.removeEntry(e.date,e.id),r.setSyncStatus(h.Synced)},f=k.debounce(u,2e3),w=()=>{f.cancel(),u()};return(y,V)=>(c(),d("li",z,[b("div",F,[l(x,{value:i(t),placeholder:"Write here...",class:"w-full","detect-enter":"",onEnter:w,"onUpdate:value":o},null,8,["value"]),l(U,{onRemove:a})])]))}}),L=p({__name:"AddEntry",props:{date:{}},setup(s){const e=s,t=_(),n=E(""),r=()=>{n.value.trim()&&t.newEntry(e.date,n.value.trim()),n.value=""};return(o,a)=>(c(),d("li",{class:J(("mergeClasses"in o?o.mergeClasses:i(B))("m-0","marker:text-base-300","flex","flex-nowrap","items-center","gap-x-2"))},[l(x,{value:i(n),"onUpdate:value":a[0]||(a[0]=u=>C(n)?n.value=u:null),placeholder:"Write here...",class:"w-full","detect-enter":"",onEnter:r},null,8,["value"]),l(v,{icon:i(K),class:"btn-circle !btn-xs",onClick:r},null,8,["icon"])],2))}}),P={class:"list-disc pl-8"},Y=p({__name:"EntryList",props:{date:{}},setup(s){const e=s,t=_(),n=M(()=>t.getEntries(e.date));return(r,o)=>(c(),d("ul",P,[(c(!0),d(N,null,j(i(n),a=>(c(),A(I,{entry:a.text,id:a.id,date:a.date,key:`entry-${a.id}`},null,8,["entry","id","date"]))),128)),l(L,{date:e.date},null,8,["date"])]))}});export{Y as _};
