import{g as N,h as q,o as E,c as k,a as T,t as O,j as d,i as $,M as re,q as oe,s as X,w as M,b as f,r as y,H as le,S as ue,T as ie,U as de,V as ce,L as me,d as x,z as I,K as J,F as V,n as ve,W as fe,y as pe,x as ge,J as he}from"./entry.fdeab8e2.js";import{_ as _e,c as R,b as K,a as ye}from"./SelectField.vue.2b791b6b.js";import{r as g,t as p,a as C,_ as Me,b as Q,s as W,c as j,m as be,d as De,f as Y,p as Ee}from"./index.504780f4.js";import{_ as Z,a as P,b as Ie,c as ee}from"./InputField.vue.bc217c63.js";import{e as Ce,u as L,F as H}from"./eventStore.e7e86ec9.js";import{a as Ue}from"./index.5054022f.js";import{_ as Te}from"./FABButton.vue.20dd3cf1.js";import{_ as Ne}from"./TagSelecter.vue.3494ce3c.js";function qe(a,t){g(2,arguments);var e=p(a),n=C(t);if(isNaN(n))return new Date(NaN);if(!n)return e;var s=e.getDate(),l=new Date(e.getTime());l.setMonth(e.getMonth()+n+1,0);var r=l.getDate();return s>=r?l:(e.setFullYear(l.getFullYear(),l.getMonth(),s),e)}function S(a,t){if(g(2,arguments),!t||Me(t)!=="object")return new Date(NaN);var e=t.years?C(t.years):0,n=t.months?C(t.months):0,s=t.weeks?C(t.weeks):0,l=t.days?C(t.days):0,r=t.hours?C(t.hours):0,i=t.minutes?C(t.minutes):0,u=t.seconds?C(t.seconds):0,o=p(a),h=n||e?qe(o,n+e*12):o,_=l||s?Ue(h,l+s*7):h,U=i+r*60,F=u+U*60,v=F*1e3,c=new Date(_.getTime()+v);return c}var $e=36e5;function Fe(a,t){g(2,arguments);var e=C(t);return Q(a,e*$e)}var ke=864e5;function we(a,t){g(2,arguments);var e=W(a),n=W(t),s=e.getTime()-j(e),l=n.getTime()-j(n);return Math.round((s-l)/ke)}var Se=6e4;function xe(a,t){g(2,arguments);var e=C(t);return Q(a,e*Se)}function w(a,t){g(2,arguments);var e=p(a),n=p(t),s=e.getTime()-n.getTime();return s<0?-1:s>0?1:s}function Oe(a,t){g(2,arguments);var e=p(a),n=p(t),s=e.getFullYear()-n.getFullYear(),l=e.getMonth()-n.getMonth();return s*12+l}function He(a,t){g(2,arguments);var e=p(a),n=p(t);return e.getFullYear()-n.getFullYear()}function z(a,t){var e=a.getFullYear()-t.getFullYear()||a.getMonth()-t.getMonth()||a.getDate()-t.getDate()||a.getHours()-t.getHours()||a.getMinutes()-t.getMinutes()||a.getSeconds()-t.getSeconds()||a.getMilliseconds()-t.getMilliseconds();return e<0?-1:e>0?1:e}function Ye(a,t){g(2,arguments);var e=p(a),n=p(t),s=z(e,n),l=Math.abs(we(e,n));e.setDate(e.getDate()-s*l);var r=+(z(e,n)===-s),i=s*(l-r);return i===0?0:i}function A(a,t){return g(2,arguments),p(a).getTime()-p(t).getTime()}var G={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)}},Re="trunc";function B(a){return a?G[a]:G[Re]}function Le(a,t,e){g(2,arguments);var n=A(a,t)/be;return B(e==null?void 0:e.roundingMethod)(n)}function Ae(a,t,e){g(2,arguments);var n=A(a,t)/De;return B(e==null?void 0:e.roundingMethod)(n)}function Be(a){g(1,arguments);var t=p(a),e=t.getMonth();return t.setFullYear(t.getFullYear(),e+1,0),t.setHours(23,59,59,999),t}function Ve(a){g(1,arguments);var t=p(a);return Ce(t).getTime()===Be(t).getTime()}function We(a,t){g(2,arguments);var e=p(a),n=p(t),s=w(e,n),l=Math.abs(Oe(e,n)),r;if(l<1)r=0;else{e.getMonth()===1&&e.getDate()>27&&e.setDate(30),e.setMonth(e.getMonth()-s*l);var i=w(e,n)===-s;Ve(p(a))&&l===1&&w(a,n)===1&&(i=!1),r=s*(l-Number(i))}return r===0?0:r}function je(a,t,e){g(2,arguments);var n=A(a,t)/1e3;return B(e==null?void 0:e.roundingMethod)(n)}function Pe(a,t){g(2,arguments);var e=p(a),n=p(t),s=w(e,n),l=Math.abs(He(e,n));e.setFullYear(1584),n.setFullYear(1584);var r=w(e,n)===-s,i=s*(l-Number(r));return i===0?0:i}function ze(a){g(1,arguments);var t=p(a.start),e=p(a.end);if(isNaN(t.getTime()))throw new RangeError("Start Date is invalid");if(isNaN(e.getTime()))throw new RangeError("End Date is invalid");var n={};n.years=Math.abs(Pe(e,t));var s=w(e,t),l=S(t,{years:s*n.years});n.months=Math.abs(We(e,l));var r=S(l,{months:s*n.months});n.days=Math.abs(Ye(e,r));var i=S(r,{days:s*n.days});n.hours=Math.abs(Le(e,i));var u=S(i,{hours:s*n.hours});n.minutes=Math.abs(Ae(e,u));var o=S(u,{minutes:s*n.minutes});return n.seconds=Math.abs(je(e,o)),n}const Ge={class:"flex-grow"},Xe={class:"text-xs font-light leading-3"},Je={class:"focus:outline-none text-lg font-medium leading-5"},Ke=N({__name:"CalendarEvent",props:{start:{},end:{},title:{},description:{},tag:{}},setup(a){const t=a,e=q(()=>{if(!t.start&&!t.end)return"Whole day";if(t.start&&!t.end)return Y(t.start,"H:mm");if(t.start&&t.end)return`${Y(t.start,"H:mm")} - ${Y(t.end,"H:mm")}`});return(n,s)=>(E(),k("div",{class:oe(("mergeClasses"in n?n.mergeClasses:d(X))("border-b","last-of-type:border-b-0","p-2","border-base-300","border-dashed","cursor-pointer","flex","items-center"))},[T("div",Ge,[T("p",Xe,O(d(e)),1),T("p",Je,O(t.title),1)]),t.tag?(E(),$(_e,{key:0,icon:t.tag.icon,color:t.tag.color},null,8,["icon","color"])):re("",!0)],2))}});function te(a){return Y(a,"yyyy-MM-dd")}function Qe(a,t){return ze({start:a,end:t})}function Ze(a){return Ee(a,"yyyy-MM-dd",new Date)}function ne(a,t){const e=Ze(a);return t[0]&&e.setHours(t[0]),t[1]&&e.setMinutes(t[1]),e}function ae(a,t){let e=Fe(a,t[0]??0);return e=xe(e,t[1]??0),e}const et={class:"grid grid-cols-2 gap-2"},tt=N({__name:"DurationPicker",props:{hours:{},minutes:{},labelClass:{}},emits:["update:hours","update:minutes"],setup(a,{emit:t}){const e=a,n=[...Array(24)].map((u,o)=>({text:("00"+o).slice(-2),value:o})),s=[...Array(12)].map((u,o)=>({text:("00"+5*o).slice(-2),value:5*o})),l=q(()=>(e.hours===void 0?"--":("00"+e.hours).slice(-2))+":"+(e.minutes===void 0?"--":("00"+e.minutes).slice(-2))),r=u=>t("update:hours",u),i=u=>t("update:minutes",u);return(u,o)=>(E(),$(K,{"label-class":e.labelClass},{label:M(()=>[T("span",null,O(d(l)),1)]),content:M(()=>[T("div",et,[f(R,{elements:d(n),selected:e.hours,onSelect:r},null,8,["elements","selected"]),f(R,{elements:d(s),selected:e.minutes,onSelect:i},null,8,["elements","selected"])])]),_:1},8,["label-class"]))}}),nt=N({__name:"DurationField",props:{label:{},clearable:{type:Boolean},icon:{},hours:{},minutes:{},required:{type:Boolean}},emits:["clear","update:hours","update:minutes"],setup(a,{emit:t}){const e=a,n=()=>t("clear"),s=o=>t("update:hours",o),l=o=>t("update:minutes",o),r=q(()=>(e.hours===void 0?"--":("00"+e.hours).slice(-2))+":"+(e.minutes===void 0?"--":("00"+e.minutes).slice(-2))),i=new RegExp("[0-9]{2}:[0-9]{2}"),u=e.required?[o=>i.test(o)]:[];return(o,h)=>(E(),$(Z,{icon:e.icon,clearable:e.clearable,label:e.label,value:d(r),onClear:n,rules:d(u)},{input:M(({inputClass:_})=>[f(tt,{hours:e.hours,minutes:e.minutes,"label-class":_,class:"flex-shrink w-full","onUpdate:hours":s,"onUpdate:minutes":l},null,8,["hours","minutes","label-class"])]),_:1},8,["icon","clearable","label","value","rules"]))}}),at={class:"grid grid-cols-2 gap-2"},st=N({__name:"TimePicker",props:{hours:{},minutes:{},labelClass:{}},emits:["update:hours","update:minutes"],setup(a,{emit:t}){const e=a,n=[...Array(24)].map((u,o)=>({text:("00"+o).slice(-2),value:o})),s=[...Array(12)].map((u,o)=>({text:("00"+5*o).slice(-2),value:5*o})),l=q(()=>(e.hours===void 0?"--":("00"+e.hours).slice(-2))+":"+(e.minutes===void 0?"--":("00"+e.minutes).slice(-2))),r=u=>t("update:hours",u),i=u=>t("update:minutes",u);return(u,o)=>(E(),$(K,{"label-class":e.labelClass},{label:M(()=>[T("span",null,O(d(l)),1)]),content:M(()=>[T("div",at,[f(R,{elements:d(n),selected:e.hours,onSelect:r},null,8,["elements","selected"]),f(R,{elements:d(s),selected:e.minutes,onSelect:i},null,8,["elements","selected"])])]),_:1},8,["label-class"]))}}),rt=N({__name:"TimeField",props:{label:{},clearable:{type:Boolean},icon:{},hours:{},minutes:{},required:{type:Boolean}},emits:["clear","update:hours","update:minutes"],setup(a,{emit:t}){const e=a,n=()=>t("clear"),s=o=>t("update:hours",o),l=o=>t("update:minutes",o),r=q(()=>(e.hours===void 0?"--":("00"+e.hours).slice(-2))+":"+(e.minutes===void 0?"--":("00"+e.minutes).slice(-2))),i=new RegExp("[0-9]{2}:[0-9]{2}"),u=e.required?[o=>i.test(o)]:[];return(o,h)=>(E(),$(Z,{icon:e.icon,clearable:e.clearable,label:e.label,value:d(r),onClear:n,rules:d(u)},{input:M(({inputClass:_})=>[f(st,{hours:e.hours,minutes:e.minutes,"label-class":_,class:"flex-shrink w-full","onUpdate:hours":s,"onUpdate:minutes":l},null,8,["hours","minutes","label-class"])]),_:1},8,["icon","clearable","label","value","rules"]))}}),se=N({__name:"EventForm",props:{title:{},date:{},time:{},duration:{},frequency:{},tagId:{}},emits:["update:title","update:date","update:time","update:duration","update:frequency","update:tagId"],setup(a,{expose:t,emit:e}){const n=a,s=L(),l=y(null),r=Object.entries(H).map(([v,c])=>({text:v,value:c})),i=v=>e("update:title",v),u=v=>e("update:date",v),o=v=>e("update:time",v),h=v=>e("update:duration",v),_=v=>e("update:frequency",v),U=v=>e("update:tagId",v);return t({validate:()=>{var v;return(v=l.value)==null?void 0:v.validate()}}),(v,c)=>(E(),$(Ie,{ref_key:"form",ref:l},{default:M(()=>[f(P,{label:"Event Name",placeholder:"Enter name...",value:n.title,icon:d(le),"onUpdate:value":i,rules:[m=>!!m]},null,8,["value","icon","rules"]),f(P,{type:"date",label:"Event Date",placeholder:"Enter date...",value:v.date,icon:d(ue),"onUpdate:value":u,rules:[m=>!!m]},null,8,["value","icon","rules"]),f(rt,{label:"Event Time",icon:d(ie),hours:n.time[0],minutes:n.time[1],"onUpdate:hours":c[0]||(c[0]=m=>o([m,n.time[1]])),"onUpdate:minutes":c[1]||(c[1]=m=>o([n.time[0],m])),required:""},null,8,["icon","hours","minutes"]),f(nt,{label:"Event Duration",icon:d(de),hours:n.duration[0],minutes:n.duration[1],"onUpdate:hours":c[2]||(c[2]=m=>h([m,n.duration[1]])),"onUpdate:minutes":c[3]||(c[3]=m=>h([n.duration[0],m])),required:""},null,8,["icon","hours","minutes"]),f(ye,{label:"Frequency",icon:d(ce),options:d(r),value:v.frequency,"onUpdate:value":_,rules:[m=>!!m]},null,8,["icon","options","value","rules"]),f(Ne,{tags:d(s).tagArray,selected:n.tagId,"onUpdate:selected":U,clearable:""},null,8,["tags","selected"])]),_:1},512))}}),ot=N({__name:"EditEvent",props:{event:{}},emits:["close"],setup(a,{emit:t}){const e=a,n=L(),s=y(null),l=q(()=>!!e.event),r=y(""),i=y(""),u=y([void 0,void 0]),o=y([1,0]),h=y(H.Once),_=y(""),U=()=>t("close"),F=()=>{var m;if(!e.event||!((m=s.value)!=null&&m.validate()))return;const c=ne(i.value,u.value);n.editEvent(e.event.id,{title:r.value,frequency:h.value,start:c,end:ae(c,o.value),tagId:_.value}),U()},v=()=>{e.event&&(n.removeEvent(e.event.id),U())};return me(()=>{if(e.event)if(r.value=e.event.title,i.value=te(e.event.start),u.value=[e.event.start.getHours(),e.event.start.getMinutes()],h.value=e.event.frequency,_.value=e.event.tagId,e.event.end){const c=Qe(e.event.start,e.event.end);o.value=[c.hours,c.minutes]}else o.value=[0,0];else r.value="",i.value="",u.value=[void 0,void 0],o.value=[1,0],h.value=H.Once,_.value=""}),(c,m)=>{const b=J;return E(),$(ee,{"is-opened":d(l),onClose:U},{title:M(()=>{var D;return[x("Update event '"+O((D=e.event)==null?void 0:D.title)+"'",1)]}),default:M(()=>[f(se,{title:d(r),"onUpdate:title":m[0]||(m[0]=D=>I(r)?r.value=D:null),date:d(i),"onUpdate:date":m[1]||(m[1]=D=>I(i)?i.value=D:null),time:d(u),"onUpdate:time":m[2]||(m[2]=D=>I(u)?u.value=D:null),duration:d(o),"onUpdate:duration":m[3]||(m[3]=D=>I(o)?o.value=D:null),frequency:d(h),"onUpdate:frequency":m[4]||(m[4]=D=>I(h)?h.value=D:null),"tag-id":d(_),"onUpdate:tagId":m[5]||(m[5]=D=>I(_)?_.value=D:null),ref_key:"form",ref:s},null,8,["title","date","time","duration","frequency","tag-id"])]),actions:M(()=>[f(b,{class:"btn-error ml-2",onClick:v},{default:M(()=>[x("Delete")]),_:1}),f(b,{class:"btn-success ml-2",onClick:F},{default:M(()=>[x("Save")]),_:1})]),_:1},8,["is-opened"])}}}),lt={class:"menu"},ut=T("div",{class:"text-center font-light py-4"},"No event for this day...",-1),ht=N({__name:"CalendarEvents",props:{day:{},tagFilter:{}},setup(a){const t=a,e=L(),n=y(null),s=q(()=>ge(e.getEventsOfDay(t.day)).chain().filter(r=>!t.tagFilter||r.tagId===t.tagFilter).sortBy([r=>r.start.getHours(),r=>r.start.getMinutes()]).map(r=>({event:r,tag:e.tags.get(r.tagId)})).value()),l=r=>n.value=r;return(r,i)=>(E(),k("div",null,[d(s).length>0?(E(),k(V,{key:0},[T("ul",lt,[(E(!0),k(V,null,ve(d(s),({event:u,tag:o})=>(E(),k("li",{key:"event-"+u.id},[f(Ke,fe(u,{tag:o,onClick:h=>l(u),class:("mergeClasses"in r?r.mergeClasses:d(X))("px-6","rounded-box")}),null,16,["tag","onClick","class"])]))),128))]),f(ot,{event:d(n),onClose:i[0]||(i[0]=()=>l(null))},null,8,["event"])],64)):pe(r.$slots,"no-event",{key:1},()=>[ut])]))}}),_t=N({__name:"CreateEvent",setup(a){const t=L(),e=y(!1),n=y(null),s=y(""),l=y(te(new Date)),r=y([new Date().getHours()+1,0]),i=y([1,0]),u=y(H.Once),o=y(""),h=()=>e.value=!0,_=()=>e.value=!1,U=()=>{var c;if(!((c=n.value)!=null&&c.validate()))return;const v=ne(l.value,r.value);t.newEvent({title:s.value,frequency:u.value,start:v,end:ae(v,i.value),tagId:o.value}),_(),F()},F=()=>{s.value="",l.value="",r.value=[void 0,void 0],i.value=[1,0],u.value=H.Once,o.value=""};return(v,c)=>{const m=J;return E(),k("div",null,[f(Te,{icon:d(he),class:"-bottom-4 right-4",onClick:h},null,8,["icon"]),f(ee,{"is-opened":d(e),onClose:_},{title:M(()=>[x("Create a new event")]),default:M(()=>[f(se,{title:d(s),"onUpdate:title":c[0]||(c[0]=b=>I(s)?s.value=b:null),date:d(l),"onUpdate:date":c[1]||(c[1]=b=>I(l)?l.value=b:null),time:d(r),"onUpdate:time":c[2]||(c[2]=b=>I(r)?r.value=b:null),duration:d(i),"onUpdate:duration":c[3]||(c[3]=b=>I(i)?i.value=b:null),frequency:d(u),"onUpdate:frequency":c[4]||(c[4]=b=>I(u)?u.value=b:null),"tag-id":d(o),"onUpdate:tagId":c[5]||(c[5]=b=>I(o)?o.value=b:null),ref_key:"form",ref:n},null,8,["title","date","time","duration","frequency","tag-id"])]),actions:M(()=>[f(m,{class:"btn-success",onClick:U},{default:M(()=>[x("Create")]),_:1})]),_:1},8,["is-opened"])])}}});export{ht as _,qe as a,_t as b};
