import{d as h}from"./PageHeading.85ead6ba.js";import{v as g}from"./entry.30a63745.js";import{r as f,t as l,f as u,p as y,s as c,e as d}from"./index.f3feb017.js";function m(t){f(1,arguments);var e=l(t);return e.setHours(23,59,59,999),e}var n=(t=>(t.Once="once",t.Daily="daily",t.Weekly="weekly",t.Monthly="monthly",t.Yearly="yearly",t))(n||{});const i=t=>u(t,"yyyy-MM-dd HH:mm"),o=t=>y(t,"yyyy-MM-dd HH:mm",new Date),w=(t,e)=>{const s=o(t.start),a=o(t.end??t.start);if(e<c(s))return!1;switch(t.frequency){case n.Once:return m(a)>=e;case n.Daily:return!0;case n.Weekly:return d({start:s,end:a}).some(r=>r.getDay()===e.getDay());case n.Monthly:return d({start:s,end:a}).some(r=>r.getDate()===e.getDate());case n.Yearly:return d({start:s,end:a}).some(r=>r.getDate()===e.getDate()&&r.getMonth()===e.getMonth());default:return!1}},I=h("events",{state:()=>({events:new Map,tags:new Map,nextEventId:0,nextTagId:0}),getters:{tagArray:t=>[...t.tags.values()]},actions:{getEventsOfDay(t){return[...this.events.values()].filter(e=>w(e,t)).map(e=>({id:e.id,frequency:e.frequency,start:o(e.start),title:e.title,end:e.end?o(e.end):void 0,tagId:e.tagId}))},newEvent(t){const e={id:this.nextEventId,title:t.title,frequency:t.frequency,start:i(t.start),end:t.end?i(t.end):void 0,tagId:t.tagId};this.events.set(this.nextEventId,e),this.nextEventId++},editEvent(t,e){const s=this.events.get(t);if(!s)throw new Error(`[Events] Key ${t} not found`);const a={id:t,title:e.title??s.title,frequency:e.frequency??s.frequency,start:e.start?i(e.start):s.start,end:e.end?i(e.end):s.end,tagId:e.tagId??s.tagId};this.events.set(t,a)},removeEvent(t){if(!this.events.delete(t))throw new Error(`[Events] Key ${t} not found`)},newTag(t,e,s){if(g.some([...this.tags.values()],a=>a.color===e))throw new Error(`[Events] Tag with color ${e} already exists`);this.tags.set(this.nextTagId,{id:this.nextTagId,title:t,color:e,icon:s}),this.nextTagId++},removeTag(t){this.tags.delete(t)},editTag(t,e,s,a){if(!this.tags.has(t))throw new Error(`[Events] Tag with ID ${t} not found`);if(g.some([...this.tags.values()],r=>r.id!==t&&r.color===s))throw new Error(`[Events] Tag with color ${s} already exists`);this.tags.set(t,{id:t,color:s,title:e,icon:a})}}});export{n as F,m as e,I as u};
