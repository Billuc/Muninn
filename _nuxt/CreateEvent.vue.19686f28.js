import{g as $,l as B,o as M,c as U,a as k,t as F,h as i,q as Y,M as re,n as z,m as L,w as I,r as P,F as R,b,x as p,H as oe,Q as le,R as ue,S as ie,T as de,L as ce,d as H,z as D,K as Z,U as ve,y as me,v as fe,J as ge}from"./entry.b18e108e.js";import{_ as pe,b as he,a as ye}from"./SelectField.vue.8068d51c.js";import{r as h,t as g,a as T,_ as _e,b as ee,s as K,c as Q,m as be,d as Me,f as S,p as De}from"./index.504780f4.js";import{_ as Ce,a as W,b as Ie,c as te}from"./InputField.vue.4dc7ceed.js";import{e as Ee,u as V,F as x}from"./eventStore.dc245862.js";import{a as ke}from"./index.5054022f.js";import{_ as Te}from"./FABButton.vue.fb96622b.js";import{_ as Ue}from"./TagSelecter.vue.2418b4c1.js";function Ne(n,t){h(2,arguments);var e=g(n),a=T(t);if(isNaN(a))return new Date(NaN);if(!a)return e;var r=e.getDate(),o=new Date(e.getTime());o.setMonth(e.getMonth()+a+1,0);var s=o.getDate();return r>=s?o:(e.setFullYear(o.getFullYear(),o.getMonth(),r),e)}function q(n,t){if(h(2,arguments),!t||_e(t)!=="object")return new Date(NaN);var e=t.years?T(t.years):0,a=t.months?T(t.months):0,r=t.weeks?T(t.weeks):0,o=t.days?T(t.days):0,s=t.hours?T(t.hours):0,u=t.minutes?T(t.minutes):0,l=t.seconds?T(t.seconds):0,c=g(n),v=a||e?Ne(c,a+e*12):c,E=o||r?ke(v,o+r*7):v,C=u+s*60,N=l+C*60,w=N*1e3,d=new Date(E.getTime()+w);return d}var $e=36e5;function ne(n,t){h(2,arguments);var e=T(t);return ee(n,e*$e)}var we=864e5;function Fe(n,t){h(2,arguments);var e=K(n),a=K(t),r=e.getTime()-Q(e),o=a.getTime()-Q(a);return Math.round((r-o)/we)}var Oe=6e4;function ae(n,t){h(2,arguments);var e=T(t);return ee(n,e*Oe)}function O(n,t){h(2,arguments);var e=g(n),a=g(t),r=e.getTime()-a.getTime();return r<0?-1:r>0?1:r}function qe(n,t){h(2,arguments);var e=g(n),a=g(t),r=e.getFullYear()-a.getFullYear(),o=e.getMonth()-a.getMonth();return r*12+o}function He(n,t){h(2,arguments);var e=g(n),a=g(t);return e.getFullYear()-a.getFullYear()}function G(n,t){var e=n.getFullYear()-t.getFullYear()||n.getMonth()-t.getMonth()||n.getDate()-t.getDate()||n.getHours()-t.getHours()||n.getMinutes()-t.getMinutes()||n.getSeconds()-t.getSeconds()||n.getMilliseconds()-t.getMilliseconds();return e<0?-1:e>0?1:e}function Se(n,t){h(2,arguments);var e=g(n),a=g(t),r=G(e,a),o=Math.abs(Fe(e,a));e.setDate(e.getDate()-r*o);var s=+(G(e,a)===-r),u=r*(o-s);return u===0?0:u}function j(n,t){return h(2,arguments),g(n).getTime()-g(t).getTime()}var X={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)}},xe="trunc";function J(n){return n?X[n]:X[xe]}function Ye(n,t,e){h(2,arguments);var a=j(n,t)/be;return J(e==null?void 0:e.roundingMethod)(a)}function Le(n,t,e){h(2,arguments);var a=j(n,t)/Me;return J(e==null?void 0:e.roundingMethod)(a)}function Re(n){h(1,arguments);var t=g(n),e=t.getMonth();return t.setFullYear(t.getFullYear(),e+1,0),t.setHours(23,59,59,999),t}function Ae(n){h(1,arguments);var t=g(n);return Ee(t).getTime()===Re(t).getTime()}function Be(n,t){h(2,arguments);var e=g(n),a=g(t),r=O(e,a),o=Math.abs(qe(e,a)),s;if(o<1)s=0;else{e.getMonth()===1&&e.getDate()>27&&e.setDate(30),e.setMonth(e.getMonth()-r*o);var u=O(e,a)===-r;Ae(g(n))&&o===1&&O(n,a)===1&&(u=!1),s=r*(o-Number(u))}return s===0?0:s}function Ve(n,t,e){h(2,arguments);var a=j(n,t)/1e3;return J(e==null?void 0:e.roundingMethod)(a)}function We(n,t){h(2,arguments);var e=g(n),a=g(t),r=O(e,a),o=Math.abs(He(e,a));e.setFullYear(1584),a.setFullYear(1584);var s=O(e,a)===-r,u=r*(o-Number(s));return u===0?0:u}function ze(n){h(1,arguments);var t=g(n.start),e=g(n.end);if(isNaN(t.getTime()))throw new RangeError("Start Date is invalid");if(isNaN(e.getTime()))throw new RangeError("End Date is invalid");var a={};a.years=Math.abs(We(e,t));var r=O(e,t),o=q(t,{years:r*a.years});a.months=Math.abs(Be(e,o));var s=q(o,{months:r*a.months});a.days=Math.abs(Se(e,s));var u=q(s,{days:r*a.days});a.hours=Math.abs(Ye(e,u));var l=q(u,{hours:r*a.hours});a.minutes=Math.abs(Le(e,l));var c=q(l,{minutes:r*a.minutes});return a.seconds=Math.abs(Ve(e,c)),a}const Pe={class:"flex-grow"},je={class:"text-xs font-light leading-3"},Je={class:"focus:outline-none text-lg font-medium leading-5"},Ke=$({__name:"CalendarEvent",props:{start:{},end:{},title:{},description:{},tag:{}},setup(n){const t=n,e=B(()=>{if(!t.start&&!t.end)return"Whole day";if(t.start&&!t.end)return S(t.start,"H:mm");if(t.start&&t.end)return`${S(t.start,"H:mm")} - ${S(t.end,"H:mm")}`});return(a,r)=>(M(),U("div",{class:z(("mergeClasses"in a?a.mergeClasses:i(L))("border-b","last-of-type:border-b-0","p-2","border-base-300","border-dashed","cursor-pointer","flex","items-center"))},[k("div",Pe,[k("p",je,F(i(e)),1),k("p",Je,F(t.title),1)]),t.tag?(M(),Y(pe,{key:0,icon:t.tag.icon,color:t.tag.color},null,8,["icon","color"])):re("",!0)],2))}});function Qe(n){return S(n,"yyyy-MM-dd")}function Ge(n){return S(n,"HH:mm")}function Xe(n,t){return ze({start:n,end:t})}function A(n,t){return De(`${n}T${t}`,"yyyy-MM-dd'T'HH:mm",new Date)}const Ze={class:"grid grid-cols-2 gap-2"},et={class:"overflow-y-scroll h-52"},tt=["onClick"],nt={class:"overflow-y-scroll h-52"},at=["onClick"],st=$({__name:"DurationPicker",props:{hours:{},minutes:{},labelClass:{}},emits:["update:hours","update:minutes"],setup(n,{emit:t}){const e=n,a=[...Array(24)].map((l,c)=>c),r=[...Array(12)].map((l,c)=>5*c),o=B(()=>("00"+e.hours).slice(-2)+":"+("00"+e.minutes).slice(-2)),s=l=>t("update:hours",l),u=l=>t("update:minutes",l);return(l,c)=>(M(),Y(he,{"label-class":e.labelClass},{label:I(()=>[k("span",null,F(i(o)),1)]),content:I(()=>[k("div",Ze,[k("div",et,[(M(!0),U(R,null,P(i(a),v=>(M(),U("div",{key:"hours-"+v,onClick:()=>s(v)},[k("div",{class:z(("mergeClasses"in l?l.mergeClasses:i(L))("py-2","font-semibold","bg-base-100","hover:bg-base-300","mx-auto","w-full","drop-shadow-xl","border-0","text-center","rounded-box","mb-1"))},F(("00"+v).slice(-2)),3)],8,tt))),128))]),k("div",nt,[(M(!0),U(R,null,P(i(r),v=>(M(),U("div",{key:"minutes-"+v,onClick:()=>u(v)},[k("div",{class:z(("mergeClasses"in l?l.mergeClasses:i(L))("py-2","font-semibold","bg-base-100","hover:bg-base-300","mx-auto","w-full","drop-shadow-xl","border-0","text-center","rounded-box","mb-1"))},F(("00"+v).slice(-2)),3)],8,at))),128))])])]),_:1},8,["label-class"]))}}),rt=$({__name:"DurationField",props:{label:{},clearable:{type:Boolean},icon:{},hours:{},minutes:{}},emits:["clear","update:hours","update:minutes"],setup(n,{emit:t}){const e=n,a=()=>t("clear"),r=s=>t("update:hours",s),o=s=>t("update:minutes",s);return(s,u)=>(M(),Y(Ce,{icon:e.icon,clearable:e.clearable,label:e.label,value:"",onClear:a},{input:I(({inputClass:l})=>[b(st,{hours:e.hours,minutes:e.minutes,"label-class":l,class:"flex-shrink w-full","onUpdate:hours":r,"onUpdate:minutes":o},null,8,["hours","minutes","label-class"])]),_:1},8,["icon","clearable","label"]))}}),se=$({__name:"EventForm",props:{title:{},date:{},time:{},hours:{},minutes:{},frequency:{},tagId:{}},emits:["update:title","update:date","update:time","update:hours","update:minutes","update:frequency","update:tagId"],setup(n,{expose:t,emit:e}){const a=n,r=V(),o=p(null),s=Object.entries(x).map(([d,m])=>({text:d,value:m})),u=d=>e("update:title",d),l=d=>e("update:date",d),c=d=>e("update:time",d),v=d=>e("update:hours",d),E=d=>e("update:minutes",d),C=d=>e("update:frequency",d),N=d=>e("update:tagId",d);return t({validate:()=>{var d;return(d=o.value)==null?void 0:d.validate()}}),(d,m)=>(M(),Y(Ie,{ref_key:"form",ref:o},{default:I(()=>[b(W,{label:"Event Name",placeholder:"Enter name...",value:a.title,icon:i(oe),"onUpdate:value":u,rules:[f=>!!f]},null,8,["value","icon","rules"]),b(W,{type:"date",label:"Event Date",placeholder:"Enter date...",value:d.date,icon:i(le),"onUpdate:value":l,rules:[f=>!!f]},null,8,["value","icon","rules"]),b(W,{type:"time",label:"Event Time",placeholder:"Enter time...",value:d.time,icon:i(ue),"onUpdate:value":c,rules:[f=>!!f]},null,8,["value","icon","rules"]),b(rt,{label:"Event Duration",icon:i(ie),hours:a.hours,minutes:a.minutes,"onUpdate:hours":v,"onUpdate:minutes":E},null,8,["icon","hours","minutes"]),b(ye,{label:"Frequency",icon:i(de),options:i(s),value:d.frequency,"onUpdate:value":C,rules:[f=>!!f]},null,8,["icon","options","value","rules"]),b(Ue,{tags:i(r).tagArray,selected:a.tagId,"onUpdate:selected":N,clearable:""},null,8,["tags","selected"])]),_:1},512))}}),ot=$({__name:"EditEvent",props:{event:{}},emits:["close"],setup(n,{emit:t}){const e=n,a=V(),r=p(null),o=B(()=>!!e.event),s=p(""),u=p(""),l=p(""),c=p(1),v=p(0),E=p(x.Once),C=p(-1),N=()=>t("close"),w=()=>{var m;e.event&&(m=r.value)!=null&&m.validate()&&(a.editEvent(e.event.id,{title:s.value,frequency:E.value,start:A(u.value,l.value),end:ae(ne(A(u.value,l.value),c.value),v.value),tagId:C.value}),N())},d=()=>{e.event&&(a.removeEvent(e.event.id),N())};return ce(()=>{if(e.event)if(s.value=e.event.title,u.value=Qe(e.event.start),l.value=Ge(e.event.start),E.value=e.event.frequency,C.value=e.event.tagId,e.event.end){const m=Xe(e.event.start,e.event.end);c.value=m.hours??0,v.value=m.minutes??0}else c.value=0,v.value=0;else s.value="",u.value="",l.value="",c.value=1,v.value=0,E.value=x.Once,C.value=-1}),(m,f)=>{const y=Z;return M(),Y(te,{"is-opened":i(o),onClose:N},{title:I(()=>{var _;return[H("Update event '"+F((_=e.event)==null?void 0:_.title)+"'",1)]}),default:I(()=>[b(se,{title:i(s),"onUpdate:title":f[0]||(f[0]=_=>D(s)?s.value=_:null),date:i(u),"onUpdate:date":f[1]||(f[1]=_=>D(u)?u.value=_:null),time:i(l),"onUpdate:time":f[2]||(f[2]=_=>D(l)?l.value=_:null),hours:i(c),"onUpdate:hours":f[3]||(f[3]=_=>D(c)?c.value=_:null),minutes:i(v),"onUpdate:minutes":f[4]||(f[4]=_=>D(v)?v.value=_:null),frequency:i(E),"onUpdate:frequency":f[5]||(f[5]=_=>D(E)?E.value=_:null),"tag-id":i(C),"onUpdate:tagId":f[6]||(f[6]=_=>D(C)?C.value=_:null),ref_key:"form",ref:r},null,8,["title","date","time","hours","minutes","frequency","tag-id"])]),actions:I(()=>[b(y,{class:"btn-error ml-2",onClick:d},{default:I(()=>[H("Delete")]),_:1}),b(y,{class:"btn-success ml-2",onClick:w},{default:I(()=>[H("Save")]),_:1})]),_:1},8,["is-opened"])}}}),lt={class:"menu"},ut=k("div",{class:"text-center font-light py-4"},"No event for this day...",-1),ht=$({__name:"CalendarEvents",props:{day:{},tagFilter:{}},setup(n){const t=n,e=V(),a=p(null),r=B(()=>fe(e.getEventsOfDay(t.day)).chain().filter(s=>(t.tagFilter??-1)<0||s.tagId===t.tagFilter).sortBy([s=>s.start.getHours(),s=>s.start.getMinutes()]).map(s=>({event:s,tag:e.tags.get(s.tagId)})).value()),o=s=>a.value=s;return(s,u)=>(M(),U("div",null,[i(r).length>0?(M(),U(R,{key:0},[k("ul",lt,[(M(!0),U(R,null,P(i(r),({event:l,tag:c})=>(M(),U("li",{key:"event-"+l.id},[b(Ke,ve(l,{tag:c,onClick:v=>o(l),class:("mergeClasses"in s?s.mergeClasses:i(L))("px-6","rounded-box")}),null,16,["tag","onClick","class"])]))),128))]),b(ot,{event:i(a),onClose:u[0]||(u[0]=()=>o(null))},null,8,["event"])],64)):me(s.$slots,"no-event",{key:1},()=>[ut])]))}}),yt=$({__name:"CreateEvent",setup(n){const t=V(),e=p(!1),a=p(null),r=p(""),o=p(""),s=p(""),u=p(1),l=p(0),c=p(x.Once),v=p(-1),E=()=>e.value=!0,C=()=>e.value=!1,N=()=>{var d;(d=a.value)!=null&&d.validate()&&(t.newEvent({title:r.value,frequency:c.value,start:A(o.value,s.value),end:ae(ne(A(o.value,s.value),u.value),l.value),tagId:v.value}),C(),w())},w=()=>{r.value="",o.value="",s.value="",u.value=1,l.value=0,c.value=x.Once,v.value=-1};return(d,m)=>{const f=Z;return M(),U("div",null,[b(Te,{icon:i(ge),class:"-bottom-4 right-4",onClick:E},null,8,["icon"]),b(te,{"is-opened":i(e),onClose:C},{title:I(()=>[H("Create a new event")]),default:I(()=>[b(se,{title:i(r),"onUpdate:title":m[0]||(m[0]=y=>D(r)?r.value=y:null),date:i(o),"onUpdate:date":m[1]||(m[1]=y=>D(o)?o.value=y:null),time:i(s),"onUpdate:time":m[2]||(m[2]=y=>D(s)?s.value=y:null),hours:i(u),"onUpdate:hours":m[3]||(m[3]=y=>D(u)?u.value=y:null),minutes:i(l),"onUpdate:minutes":m[4]||(m[4]=y=>D(l)?l.value=y:null),frequency:i(c),"onUpdate:frequency":m[5]||(m[5]=y=>D(c)?c.value=y:null),"tag-id":i(v),"onUpdate:tagId":m[6]||(m[6]=y=>D(v)?v.value=y:null),ref_key:"form",ref:a},null,8,["title","date","time","hours","minutes","frequency","tag-id"])]),actions:I(()=>[b(f,{class:"btn-success",onClick:N},{default:I(()=>[H("Create")]),_:1})]),_:1},8,["is-opened"])])}}});export{ht as _,Ne as a,yt as b};
