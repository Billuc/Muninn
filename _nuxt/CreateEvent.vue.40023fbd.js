import{g as F,s as L,o as h,c as D,a as _,t as k,h as u,l as A,q as W,n as z,m as H,B as ce,M as ae,y as X,d as N,F as P,r as se,N as ve,E as G,v as re,b as g,O as fe,L as me,P as ge,Q as pe,R as ye,w as C,C as he,x as b,G as be,K as M,D as Me}from"./entry.5564aef3.js";import{_ as j,a as _e}from"./Tag.4288d6f9.js";import{r as p,t as m,a as T,_ as De,s as Z,b as ee,c as Ce,m as Ie,d as Ee,f as U,p as oe}from"./index.f3feb017.js";import{_ as le}from"./Dialog.vue.f18504cd.js";import{e as Te,u as V,F as B}from"./eventStore.18719fad.js";import{a as we}from"./index.6e1b1773.js";import{_ as ke}from"./FABButton.vue.1ba6035c.js";import{_ as Ne}from"./InputAlt.vue.c3982aa6.js";function $e(a,e){p(2,arguments);var t=m(a),n=T(e);if(isNaN(n))return new Date(NaN);if(!n)return t;var r=t.getDate(),o=new Date(t.getTime());o.setMonth(t.getMonth()+n+1,0);var s=o.getDate();return r>=s?o:(t.setFullYear(o.getFullYear(),o.getMonth(),r),t)}function S(a,e){if(p(2,arguments),!e||De(e)!=="object")return new Date(NaN);var t=e.years?T(e.years):0,n=e.months?T(e.months):0,r=e.weeks?T(e.weeks):0,o=e.days?T(e.days):0,s=e.hours?T(e.hours):0,i=e.minutes?T(e.minutes):0,f=e.seconds?T(e.seconds):0,c=m(a),y=n||t?$e(c,n+t*12):c,I=o||r?we(y,o+r*7):y,w=i+s*60,l=f+w*60,E=l*1e3,d=new Date(I.getTime()+E);return d}var Fe=864e5;function Oe(a,e){p(2,arguments);var t=Z(a),n=Z(e),r=t.getTime()-ee(t),o=n.getTime()-ee(n);return Math.round((r-o)/Fe)}var qe=6e4;function ue(a,e){p(2,arguments);var t=T(e);return Ce(a,t*qe)}function $(a,e){p(2,arguments);var t=m(a),n=m(e),r=t.getTime()-n.getTime();return r<0?-1:r>0?1:r}function xe(a,e){p(2,arguments);var t=m(a),n=m(e),r=t.getFullYear()-n.getFullYear(),o=t.getMonth()-n.getMonth();return r*12+o}function Se(a,e){p(2,arguments);var t=m(a),n=m(e);return t.getFullYear()-n.getFullYear()}function te(a,e){var t=a.getFullYear()-e.getFullYear()||a.getMonth()-e.getMonth()||a.getDate()-e.getDate()||a.getHours()-e.getHours()||a.getMinutes()-e.getMinutes()||a.getSeconds()-e.getSeconds()||a.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function He(a,e){p(2,arguments);var t=m(a),n=m(e),r=te(t,n),o=Math.abs(Oe(t,n));t.setDate(t.getDate()-r*o);var s=+(te(t,n)===-r),i=r*(o-s);return i===0?0:i}function K(a,e){return p(2,arguments),m(a).getTime()-m(e).getTime()}var ne={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},Ue="trunc";function Q(a){return a?ne[a]:ne[Ue]}function Ye(a,e,t){p(2,arguments);var n=K(a,e)/Ie;return Q(t==null?void 0:t.roundingMethod)(n)}function Ae(a,e,t){p(2,arguments);var n=K(a,e)/Ee;return Q(t==null?void 0:t.roundingMethod)(n)}function Be(a){p(1,arguments);var e=m(a),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function Re(a){p(1,arguments);var e=m(a);return Te(e).getTime()===Be(e).getTime()}function Le(a,e){p(2,arguments);var t=m(a),n=m(e),r=$(t,n),o=Math.abs(xe(t,n)),s;if(o<1)s=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-r*o);var i=$(t,n)===-r;Re(m(a))&&o===1&&$(a,n)===1&&(i=!1),s=r*(o-Number(i))}return s===0?0:s}function Ve(a,e,t){p(2,arguments);var n=K(a,e)/1e3;return Q(t==null?void 0:t.roundingMethod)(n)}function We(a,e){p(2,arguments);var t=m(a),n=m(e),r=$(t,n),o=Math.abs(Se(t,n));t.setFullYear(1584),n.setFullYear(1584);var s=$(t,n)===-r,i=r*(o-Number(s));return i===0?0:i}function ze(a){p(1,arguments);var e=m(a.start),t=m(a.end);if(isNaN(e.getTime()))throw new RangeError("Start Date is invalid");if(isNaN(t.getTime()))throw new RangeError("End Date is invalid");var n={};n.years=Math.abs(We(t,e));var r=$(t,e),o=S(e,{years:r*n.years});n.months=Math.abs(Le(t,o));var s=S(o,{months:r*n.months});n.days=Math.abs(He(t,s));var i=S(s,{days:r*n.days});n.hours=Math.abs(Ye(t,i));var f=S(i,{hours:r*n.hours});n.minutes=Math.abs(Ae(t,f));var c=S(f,{minutes:r*n.minutes});return n.seconds=Math.abs(Ve(t,c)),n}const Pe={class:"flex-grow"},je={class:"text-xs font-light leading-3"},Ge={class:"focus:outline-none text-lg font-medium leading-5"},Ke=F({__name:"CalendarEvent",props:{start:{},end:{},title:{},description:{},tag:{}},setup(a){const e=a,t=L(()=>{if(!e.start&&!e.end)return"Whole day";if(e.start&&!e.end)return U(e.start,"H:mm");if(e.start&&e.end)return`${U(e.start,"H:mm")} - ${U(e.end,"H:mm")}`});return(n,r)=>(h(),D("div",{class:z(("mergeClasses"in n?n.mergeClasses:u(H))("border-b","last-of-type:border-b-0","p-2","border-base-300","border-dashed","cursor-pointer","flex","items-center"))},[_("div",Pe,[_("p",je,k(u(t)),1),_("p",Ge,k(e.title),1)]),e.tag?(h(),A(j,{key:0,icon:e.tag.icon,color:e.tag.color},null,8,["icon","color"])):W("",!0)],2))}});function Qe(a){return U(a,"yyyy-MM-dd")}function Je(a){return U(a,"HH:mm")}function Xe(a,e){var n,r;const t=ze({start:a,end:e});return`${("0"+((n=t.hours)==null?void 0:n.toString())).slice(-2)}:${("0"+((r=t.minutes)==null?void 0:r.toString())).slice(-2)}`}function R(a,e){return oe(`${a}T${e}`,"yyyy-MM-dd'T'HH:mm",new Date)}function ie(a){const e=oe(a,"HH:mm",new Date);return 60*e.getHours()+e.getMinutes()}const Ze={class:"label-text"},et={class:"dropdown flex-shrink w-52"},tt=["onClick"],nt=F({inheritAttrs:!1,__name:"SelectAlt",props:{label:{},clearable:{type:Boolean},icon:{},options:{},value:{}},emits:["clear","update:value"],setup(a,{emit:e}){const t=a,n=L(()=>t.options.find(s=>s.value===t.value)),r=()=>e("clear"),o=s=>e("update:value",s);return(s,i)=>{const f=G;return h(),D("div",{class:z(("mergeClasses"in s?s.mergeClasses:u(H))("label","gap-1","p-0"))},[_("div",null,[t.icon?(h(),A(u(ce),{key:0,icon:t.icon,class:"mr-1"},null,8,["icon"])):W("",!0),_("span",Ze,k(t.label),1)]),_("div",null,[_("div",et,[_("label",ae({tabindex:"0"},s.$attrs,{class:("mergeClasses"in s?s.mergeClasses:u(H))("focus:outline-none","bg-base-100","focus:bg-base-200","text-end","font-semibold","rounded-box","px-2","w-full","block")}),[X(s.$slots,"selected",{selected:u(n)},()=>{var c;return[N(k((c=u(n))==null?void 0:c.text),1)]})],16),_("div",{tabindex:"0",class:z(("mergeClasses"in s?s.mergeClasses:u(H))("dropdown-content","bg-base-300","w-full","rounded-box","z-[1]","text-end"))},[(h(!0),D(P,null,se(t.options,c=>(h(),D("div",{key:c.value},[X(s.$slots,"option",{option:c,onSelect:()=>o(c.value)},()=>[_("div",{onClick:()=>o(c.value),class:"px-2 rounded-box hover:bg-base-200"},k(c.text),9,tt)])]))),128))],2)]),t.clearable?(h(),A(f,{key:0,icon:u(ve),class:"btn-circle !btn-xs",onClick:r},null,8,["icon"])):W("",!0)])],2)}}}),at={class:"form-control gap-y-2"},de=F({__name:"EventForm",props:{title:{},date:{},time:{},duration:{},frequency:{},tagId:{}},emits:["update:title","update:date","update:time","update:duration","update:frequency","update:tagId"],setup(a,{emit:e}){const t=a,n=V(),r=Object.entries(B).map(([l,E])=>({text:l,value:E})),o=re(n.tagArray).chain().sortBy(l=>_e.get(l.color)).map(l=>({text:l.title,value:String(l.id)})).value(),s=l=>n.tags.get(Number(l)),i=l=>e("update:title",l),f=l=>e("update:date",l),c=l=>e("update:time",l),y=l=>e("update:duration",l),I=l=>e("update:frequency",l),w=l=>e("update:tagId",Number(l));return(l,E)=>{const d=Ne,O=nt;return h(),D("div",at,[g(d,{label:"Event Name",placeholder:"Enter name...",value:t.title,icon:u(fe),onInput:i},null,8,["value","icon"]),g(d,{type:"date",label:"Event Date",placeholder:"Enter name...",value:l.date,icon:u(me),onInput:f},null,8,["value","icon"]),g(d,{type:"time",label:"Event Time",placeholder:"Enter name...",value:l.time,icon:u(ge),onInput:c},null,8,["value","icon"]),g(d,{type:"time",label:"Event Duration",placeholder:"Enter name...",value:l.duration,icon:u(pe),onInput:y},null,8,["value","icon"]),g(O,{label:"Frequency",icon:u(ye),options:u(r),value:l.frequency,"onUpdate:value":I},null,8,["icon","options","value"]),g(O,{label:"Tag",icon:u(he),options:u(o),value:String(l.tagId),"onUpdate:value":w,onClear:E[0]||(E[0]=()=>w("-1")),clearable:""},{selected:C(({selected:v})=>{var Y,q,x;return[g(j,{color:v?(Y=s(v.value))==null?void 0:Y.color:void 0,icon:v?(q=s(v.value))==null?void 0:q.icon:void 0,text:v?(x=s(v.value))==null?void 0:x.title:void 0,class:"w-full !btn-xs"},null,8,["color","icon","text"])]}),option:C(({option:v,onSelect:Y})=>{var q,x,J;return[g(j,{color:(q=s(v.value))==null?void 0:q.color,icon:(x=s(v.value))==null?void 0:x.icon,text:(J=s(v.value))==null?void 0:J.title,onClick:Y,class:"w-full hover:scale-105"},null,8,["color","icon","text","onClick"])]}),_:1},8,["icon","options","value"])])}}}),st=F({__name:"EditEvent",props:{event:{}},emits:["close"],setup(a,{emit:e}){const t=a,n=V(),r=L(()=>!!t.event),o=b(""),s=b(""),i=b(""),f=b("01:00"),c=b(B.Once),y=b(-1),I=()=>e("close"),w=()=>{t.event&&(n.editEvent(t.event.id,{title:o.value,frequency:c.value,start:R(s.value,i.value),end:ue(R(s.value,i.value),ie(f.value)),tagId:y.value}),I())},l=()=>{t.event&&(n.removeEvent(t.event.id),I())};return be(()=>{t.event?(o.value=t.event.title,s.value=Qe(t.event.start),i.value=Je(t.event.start),f.value=t.event.end?Xe(t.event.start,t.event.end):"00:00",c.value=t.event.frequency,y.value=t.event.tagId):(o.value="",s.value="",i.value="",f.value="01:00",c.value=B.Once,y.value=-1)}),(E,d)=>{const O=G;return h(),A(le,{"is-opened":u(r),onClose:I},{title:C(()=>{var v;return[N("Update event '"+k((v=t.event)==null?void 0:v.title)+"'",1)]}),default:C(()=>[g(de,{title:u(o),"onUpdate:title":d[0]||(d[0]=v=>M(o)?o.value=v:null),date:u(s),"onUpdate:date":d[1]||(d[1]=v=>M(s)?s.value=v:null),time:u(i),"onUpdate:time":d[2]||(d[2]=v=>M(i)?i.value=v:null),duration:u(f),"onUpdate:duration":d[3]||(d[3]=v=>M(f)?f.value=v:null),frequency:u(c),"onUpdate:frequency":d[4]||(d[4]=v=>M(c)?c.value=v:null),"tag-id":u(y),"onUpdate:tagId":d[5]||(d[5]=v=>M(y)?y.value=v:null)},null,8,["title","date","time","duration","frequency","tag-id"])]),actions:C(()=>[g(O,{class:"btn-error ml-2",onClick:l},{default:C(()=>[N("Delete")]),_:1}),g(O,{class:"btn-success ml-2",onClick:w},{default:C(()=>[N("Save")]),_:1})]),_:1},8,["is-opened"])}}}),rt={class:"menu"},ot={key:1,class:"text-center font-light py-4"},gt=F({__name:"CalendarEvents",props:{day:{},tagFilter:{}},setup(a){const e=a,t=V(),n=b(null),r=L(()=>re(t.getEventsOfDay(e.day)).chain().filter(s=>(e.tagFilter??-1)<0||s.tagId===e.tagFilter).sortBy([s=>s.start.getHours(),s=>s.start.getMinutes()]).map(s=>({event:s,tag:t.tags.get(s.tagId)})).value()),o=s=>n.value=s;return(s,i)=>(h(),D("div",null,[u(r).length>0?(h(),D(P,{key:0},[_("ul",rt,[(h(!0),D(P,null,se(u(r),({event:f,tag:c})=>(h(),D("li",{key:"event-"+f.id},[g(Ke,ae(f,{tag:c,onClick:y=>o(f),class:("mergeClasses"in s?s.mergeClasses:u(H))("px-6","rounded-box")}),null,16,["tag","onClick","class"])]))),128))]),g(st,{event:u(n),onClose:i[0]||(i[0]=()=>o(null))},null,8,["event"])],64)):(h(),D("div",ot,"No event for this day..."))]))}}),pt=F({__name:"CreateEvent",setup(a){const e=V(),t=b(!1),n=b(""),r=b(""),o=b(""),s=b("01:00"),i=b(B.Once),f=b(-1),c=()=>t.value=!0,y=()=>t.value=!1,I=()=>{e.newEvent({title:n.value,frequency:i.value,start:R(r.value,o.value),end:ue(R(r.value,o.value),ie(s.value)),tagId:f.value}),y()};return(w,l)=>{const E=G;return h(),D("div",null,[g(ke,{icon:u(Me),class:"absolute -bottom-4 right-4 shadow-md btn-primary",onClick:c},null,8,["icon"]),g(le,{"is-opened":u(t),onClose:y},{title:C(()=>[N("Create a new event")]),default:C(()=>[g(de,{title:u(n),"onUpdate:title":l[0]||(l[0]=d=>M(n)?n.value=d:null),date:u(r),"onUpdate:date":l[1]||(l[1]=d=>M(r)?r.value=d:null),time:u(o),"onUpdate:time":l[2]||(l[2]=d=>M(o)?o.value=d:null),duration:u(s),"onUpdate:duration":l[3]||(l[3]=d=>M(s)?s.value=d:null),frequency:u(i),"onUpdate:frequency":l[4]||(l[4]=d=>M(i)?i.value=d:null),"tag-id":u(f),"onUpdate:tagId":l[5]||(l[5]=d=>M(f)?f.value=d:null)},null,8,["title","date","time","duration","frequency","tag-id"])]),actions:C(()=>[g(E,{class:"btn-success",onClick:I},{default:C(()=>[N("Create")]),_:1})]),_:1},8,["is-opened"])])}}});export{gt as _,$e as a,pt as b};
