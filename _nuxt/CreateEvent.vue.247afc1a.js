import{g as O,s as Y,o as b,c as C,a as $,t as U,h as u,l as j,q as ee,n as te,m as z,b as y,M as ne,L as ae,N as re,O as se,P as oe,x as h,G as le,w as I,d as q,K as _,E as G,F as x,r as ue,Q as ie,y as de,v as ce,D as ve}from"./entry.3c426d59.js";import{_ as fe}from"./Tag.59fa2b7b.js";import{r as g,t as f,a as D,_ as me,s as B,b as V,c as ge,m as pe,d as ye,f as w,p as K}from"./index.f3feb017.js";import{_ as Q}from"./Dialog.vue.24f220d6.js";import{e as Me,u as S,F as k}from"./eventStore.efb7706c.js";import{a as he}from"./index.6e1b1773.js";import{_ as _e}from"./FABButton.vue.7f56f62b.js";import{_ as De}from"./InputAlt.vue.eeed0fbb.js";import{a as Ie,b as be}from"./TagSelecter.vue.9504b94b.js";function Ee(a,e){g(2,arguments);var t=f(a),n=D(e);if(isNaN(n))return new Date(NaN);if(!n)return t;var r=t.getDate(),o=new Date(t.getTime());o.setMonth(t.getMonth()+n+1,0);var s=o.getDate();return r>=s?o:(t.setFullYear(o.getFullYear(),o.getMonth(),r),t)}function F(a,e){if(g(2,arguments),!e||me(e)!=="object")return new Date(NaN);var t=e.years?D(e.years):0,n=e.months?D(e.months):0,r=e.weeks?D(e.weeks):0,o=e.days?D(e.days):0,s=e.hours?D(e.hours):0,l=e.minutes?D(e.minutes):0,c=e.seconds?D(e.seconds):0,m=f(a),p=n||t?Ee(m,n+t*12):m,i=o||r?he(p,o+r*7):p,E=l+s*60,v=c+E*60,T=v*1e3,d=new Date(i.getTime()+T);return d}var Ce=864e5;function Te(a,e){g(2,arguments);var t=B(a),n=B(e),r=t.getTime()-V(t),o=n.getTime()-V(n);return Math.round((r-o)/Ce)}var Ne=6e4;function J(a,e){g(2,arguments);var t=D(e);return ge(a,t*Ne)}function N(a,e){g(2,arguments);var t=f(a),n=f(e),r=t.getTime()-n.getTime();return r<0?-1:r>0?1:r}function Fe(a,e){g(2,arguments);var t=f(a),n=f(e),r=t.getFullYear()-n.getFullYear(),o=t.getMonth()-n.getMonth();return r*12+o}function $e(a,e){g(2,arguments);var t=f(a),n=f(e);return t.getFullYear()-n.getFullYear()}function W(a,e){var t=a.getFullYear()-e.getFullYear()||a.getMonth()-e.getMonth()||a.getDate()-e.getDate()||a.getHours()-e.getHours()||a.getMinutes()-e.getMinutes()||a.getSeconds()-e.getSeconds()||a.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function qe(a,e){g(2,arguments);var t=f(a),n=f(e),r=W(t,n),o=Math.abs(Te(t,n));t.setDate(t.getDate()-r*o);var s=+(W(t,n)===-r),l=r*(o-s);return l===0?0:l}function A(a,e){return g(2,arguments),f(a).getTime()-f(e).getTime()}var P={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(e){return e<0?Math.ceil(e):Math.floor(e)}},we="trunc";function L(a){return a?P[a]:P[we]}function Oe(a,e,t){g(2,arguments);var n=A(a,e)/pe;return L(t==null?void 0:t.roundingMethod)(n)}function ke(a,e,t){g(2,arguments);var n=A(a,e)/ye;return L(t==null?void 0:t.roundingMethod)(n)}function He(a){g(1,arguments);var e=f(a),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function Se(a){g(1,arguments);var e=f(a);return Me(e).getTime()===He(e).getTime()}function Ue(a,e){g(2,arguments);var t=f(a),n=f(e),r=N(t,n),o=Math.abs(Fe(t,n)),s;if(o<1)s=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-r*o);var l=N(t,n)===-r;Se(f(a))&&o===1&&N(a,n)===1&&(l=!1),s=r*(o-Number(l))}return s===0?0:s}function Ye(a,e,t){g(2,arguments);var n=A(a,e)/1e3;return L(t==null?void 0:t.roundingMethod)(n)}function Ae(a,e){g(2,arguments);var t=f(a),n=f(e),r=N(t,n),o=Math.abs($e(t,n));t.setFullYear(1584),n.setFullYear(1584);var s=N(t,n)===-r,l=r*(o-Number(s));return l===0?0:l}function Le(a){g(1,arguments);var e=f(a.start),t=f(a.end);if(isNaN(e.getTime()))throw new RangeError("Start Date is invalid");if(isNaN(t.getTime()))throw new RangeError("End Date is invalid");var n={};n.years=Math.abs(Ae(t,e));var r=N(t,e),o=F(e,{years:r*n.years});n.months=Math.abs(Ue(t,o));var s=F(o,{months:r*n.months});n.days=Math.abs(qe(t,s));var l=F(s,{days:r*n.days});n.hours=Math.abs(Oe(t,l));var c=F(l,{hours:r*n.hours});n.minutes=Math.abs(ke(t,c));var m=F(c,{minutes:r*n.minutes});return n.seconds=Math.abs(Ye(t,m)),n}const Re={class:"flex-grow"},xe={class:"text-xs font-light leading-3"},Be={class:"focus:outline-none text-lg font-medium leading-5"},Ve=O({__name:"CalendarEvent",props:{start:{},end:{},title:{},description:{},tag:{}},setup(a){const e=a,t=Y(()=>{if(!e.start&&!e.end)return"Whole day";if(e.start&&!e.end)return w(e.start,"H:mm");if(e.start&&e.end)return`${w(e.start,"H:mm")} - ${w(e.end,"H:mm")}`});return(n,r)=>(b(),C("div",{class:te(("mergeClasses"in n?n.mergeClasses:u(z))("border-b","last-of-type:border-b-0","p-2","border-base-300","border-dashed","cursor-pointer","flex","items-center"))},[$("div",Re,[$("p",xe,U(u(t)),1),$("p",Be,U(e.title),1)]),e.tag?(b(),j(fe,{key:0,icon:e.tag.icon,color:e.tag.color},null,8,["icon","color"])):ee("",!0)],2))}});function We(a){return w(a,"yyyy-MM-dd")}function Pe(a){return w(a,"HH:mm")}function je(a,e){var n,r;const t=Le({start:a,end:e});return`${("0"+((n=t.hours)==null?void 0:n.toString())).slice(-2)}:${("0"+((r=t.minutes)==null?void 0:r.toString())).slice(-2)}`}function H(a,e){return K(`${a}T${e}`,"yyyy-MM-dd'T'HH:mm",new Date)}function X(a){const e=K(a,"HH:mm",new Date);return 60*e.getHours()+e.getMinutes()}const ze={class:"form-control gap-y-2"},Z=O({__name:"EventForm",props:{title:{},date:{},time:{},duration:{},frequency:{},tagId:{}},emits:["update:title","update:date","update:time","update:duration","update:frequency","update:tagId"],setup(a,{emit:e}){const t=a,n=S(),r=Object.entries(k).map(([i,E])=>({text:i,value:E})),o=i=>e("update:title",i),s=i=>e("update:date",i),l=i=>e("update:time",i),c=i=>e("update:duration",i),m=i=>e("update:frequency",i),p=i=>e("update:tagId",i);return(i,E)=>{const v=De,T=be;return b(),C("div",ze,[y(v,{label:"Event Name",placeholder:"Enter name...",value:t.title,icon:u(ne),onInput:o},null,8,["value","icon"]),y(v,{type:"date",label:"Event Date",placeholder:"Enter name...",value:i.date,icon:u(ae),onInput:s},null,8,["value","icon"]),y(v,{type:"time",label:"Event Time",placeholder:"Enter name...",value:i.time,icon:u(re),onInput:l},null,8,["value","icon"]),y(v,{type:"time",label:"Event Duration",placeholder:"Enter name...",value:i.duration,icon:u(se),onInput:c},null,8,["value","icon"]),y(T,{label:"Frequency",icon:u(oe),options:u(r),value:i.frequency,"onUpdate:value":m},null,8,["icon","options","value"]),y(Ie,{tags:u(n).tagArray,selected:t.tagId,"onUpdate:selected":p,clearable:""},null,8,["tags","selected"])])}}}),Ge=O({__name:"EditEvent",props:{event:{}},emits:["close"],setup(a,{emit:e}){const t=a,n=S(),r=Y(()=>!!t.event),o=h(""),s=h(""),l=h(""),c=h("01:00"),m=h(k.Once),p=h(-1),i=()=>e("close"),E=()=>{t.event&&(n.editEvent(t.event.id,{title:o.value,frequency:m.value,start:H(s.value,l.value),end:J(H(s.value,l.value),X(c.value)),tagId:p.value}),i())},v=()=>{t.event&&(n.removeEvent(t.event.id),i())};return le(()=>{t.event?(o.value=t.event.title,s.value=We(t.event.start),l.value=Pe(t.event.start),c.value=t.event.end?je(t.event.start,t.event.end):"00:00",m.value=t.event.frequency,p.value=t.event.tagId):(o.value="",s.value="",l.value="",c.value="01:00",m.value=k.Once,p.value=-1)}),(T,d)=>{const R=G;return b(),j(Q,{"is-opened":u(r),onClose:i},{title:I(()=>{var M;return[q("Update event '"+U((M=t.event)==null?void 0:M.title)+"'",1)]}),default:I(()=>[y(Z,{title:u(o),"onUpdate:title":d[0]||(d[0]=M=>_(o)?o.value=M:null),date:u(s),"onUpdate:date":d[1]||(d[1]=M=>_(s)?s.value=M:null),time:u(l),"onUpdate:time":d[2]||(d[2]=M=>_(l)?l.value=M:null),duration:u(c),"onUpdate:duration":d[3]||(d[3]=M=>_(c)?c.value=M:null),frequency:u(m),"onUpdate:frequency":d[4]||(d[4]=M=>_(m)?m.value=M:null),"tag-id":u(p),"onUpdate:tagId":d[5]||(d[5]=M=>_(p)?p.value=M:null)},null,8,["title","date","time","duration","frequency","tag-id"])]),actions:I(()=>[y(R,{class:"btn-error ml-2",onClick:v},{default:I(()=>[q("Delete")]),_:1}),y(R,{class:"btn-success ml-2",onClick:E},{default:I(()=>[q("Save")]),_:1})]),_:1},8,["is-opened"])}}}),Ke={class:"menu"},Qe=$("div",{class:"text-center font-light py-4"},"No event for this day...",-1),ot=O({__name:"CalendarEvents",props:{day:{},tagFilter:{}},setup(a){const e=a,t=S(),n=h(null),r=Y(()=>ce(t.getEventsOfDay(e.day)).chain().filter(s=>(e.tagFilter??-1)<0||s.tagId===e.tagFilter).sortBy([s=>s.start.getHours(),s=>s.start.getMinutes()]).map(s=>({event:s,tag:t.tags.get(s.tagId)})).value()),o=s=>n.value=s;return(s,l)=>(b(),C("div",null,[u(r).length>0?(b(),C(x,{key:0},[$("ul",Ke,[(b(!0),C(x,null,ue(u(r),({event:c,tag:m})=>(b(),C("li",{key:"event-"+c.id},[y(Ve,ie(c,{tag:m,onClick:p=>o(c),class:("mergeClasses"in s?s.mergeClasses:u(z))("px-6","rounded-box")}),null,16,["tag","onClick","class"])]))),128))]),y(Ge,{event:u(n),onClose:l[0]||(l[0]=()=>o(null))},null,8,["event"])],64)):de(s.$slots,"no-event",{key:1},()=>[Qe])]))}}),lt=O({__name:"CreateEvent",setup(a){const e=S(),t=h(!1),n=h(""),r=h(""),o=h(""),s=h("01:00"),l=h(k.Once),c=h(-1),m=()=>t.value=!0,p=()=>t.value=!1,i=()=>{e.newEvent({title:n.value,frequency:l.value,start:H(r.value,o.value),end:J(H(r.value,o.value),X(s.value)),tagId:c.value}),p()};return(E,v)=>{const T=G;return b(),C("div",null,[y(_e,{icon:u(ve),class:"absolute -bottom-4 right-4 shadow-md btn-primary",onClick:m},null,8,["icon"]),y(Q,{"is-opened":u(t),onClose:p},{title:I(()=>[q("Create a new event")]),default:I(()=>[y(Z,{title:u(n),"onUpdate:title":v[0]||(v[0]=d=>_(n)?n.value=d:null),date:u(r),"onUpdate:date":v[1]||(v[1]=d=>_(r)?r.value=d:null),time:u(o),"onUpdate:time":v[2]||(v[2]=d=>_(o)?o.value=d:null),duration:u(s),"onUpdate:duration":v[3]||(v[3]=d=>_(s)?s.value=d:null),frequency:u(l),"onUpdate:frequency":v[4]||(v[4]=d=>_(l)?l.value=d:null),"tag-id":u(c),"onUpdate:tagId":v[5]||(v[5]=d=>_(c)?c.value=d:null)},null,8,["title","date","time","duration","frequency","tag-id"])]),actions:I(()=>[y(T,{class:"btn-success",onClick:i},{default:I(()=>[q("Create")]),_:1})]),_:1},8,["is-opened"])])}}});export{ot as _,Ee as a,lt as b};
