import{g as C,h as T,o as b,c as k,a as I,t as x,j as c,i as U,z as Q,n as ee,m as G,w as M,b as g,r as E,I as te,V as ne,W as ae,X as se,Y as re,L as oe,d as H,v as F,A as le,M as V,N as ue,Z as ie,B as ce,x as de}from"./entry.0233ebe9.js";import{a as me,c as O,b as Z,_ as ve}from"./Tag.94ca284d.js";import{r as p,a as v,t as D,_ as fe,b as J,s as W,c as j,f as w}from"./index.b79af48e.js";import{a as pe}from"./index.6f6f0be5.js";import{m as ge,a as he,e as _e,p as ye,u as R,F as Y}from"./eventStore.526c15db.js";import{_ as K,a as z,b as Me,c as be}from"./InputField.vue.138e6c1a.js";import{_ as De}from"./TagSelecter.vue.e8d2a010.js";function Ee(a,t){p(2,arguments);var e=v(a),n=D(t);if(isNaN(n))return new Date(NaN);if(!n)return e;var s=e.getDate(),l=new Date(e.getTime());l.setMonth(e.getMonth()+n+1,0);var r=l.getDate();return s>=r?l:(e.setFullYear(l.getFullYear(),l.getMonth(),s),e)}function S(a,t){if(p(2,arguments),!t||fe(t)!=="object")return new Date(NaN);var e=t.years?D(t.years):0,n=t.months?D(t.months):0,s=t.weeks?D(t.weeks):0,l=t.days?D(t.days):0,r=t.hours?D(t.hours):0,i=t.minutes?D(t.minutes):0,u=t.seconds?D(t.seconds):0,o=v(a),h=n||e?Ee(o,n+e*12):o,_=l||s?pe(h,l+s*7):h,N=i+r*60,q=u+N*60,m=q*1e3,f=new Date(_.getTime()+m);return f}var Ie=36e5;function Ce(a,t){p(2,arguments);var e=D(t);return J(a,e*Ie)}var Ne=864e5;function Te(a,t){p(2,arguments);var e=W(a),n=W(t),s=e.getTime()-j(e),l=n.getTime()-j(n);return Math.round((s-l)/Ne)}var Ue=6e4;function Fe(a,t){p(2,arguments);var e=D(t);return J(a,e*Ue)}function $(a,t){p(2,arguments);var e=v(a),n=v(t),s=e.getTime()-n.getTime();return s<0?-1:s>0?1:s}function $e(a,t){p(2,arguments);var e=v(a),n=v(t),s=e.getFullYear()-n.getFullYear(),l=e.getMonth()-n.getMonth();return s*12+l}function Se(a,t){p(2,arguments);var e=v(a),n=v(t);return e.getFullYear()-n.getFullYear()}function P(a,t){var e=a.getFullYear()-t.getFullYear()||a.getMonth()-t.getMonth()||a.getDate()-t.getDate()||a.getHours()-t.getHours()||a.getMinutes()-t.getMinutes()||a.getSeconds()-t.getSeconds()||a.getMilliseconds()-t.getMilliseconds();return e<0?-1:e>0?1:e}function ke(a,t){p(2,arguments);var e=v(a),n=v(t),s=P(e,n),l=Math.abs(Te(e,n));e.setDate(e.getDate()-s*l);var r=+(P(e,n)===-s),i=s*(l-r);return i===0?0:i}function A(a,t){return p(2,arguments),v(a).getTime()-v(t).getTime()}var X={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)}},xe="trunc";function L(a){return a?X[a]:X[xe]}function qe(a,t,e){p(2,arguments);var n=A(a,t)/ge;return L(e==null?void 0:e.roundingMethod)(n)}function we(a,t,e){p(2,arguments);var n=A(a,t)/he;return L(e==null?void 0:e.roundingMethod)(n)}function Oe(a){p(1,arguments);var t=v(a),e=t.getMonth();return t.setFullYear(t.getFullYear(),e+1,0),t.setHours(23,59,59,999),t}function He(a){p(1,arguments);var t=v(a);return _e(t).getTime()===Oe(t).getTime()}function Ye(a,t){p(2,arguments);var e=v(a),n=v(t),s=$(e,n),l=Math.abs($e(e,n)),r;if(l<1)r=0;else{e.getMonth()===1&&e.getDate()>27&&e.setDate(30),e.setMonth(e.getMonth()-s*l);var i=$(e,n)===-s;He(v(a))&&l===1&&$(a,n)===1&&(i=!1),r=s*(l-Number(i))}return r===0?0:r}function Re(a,t,e){p(2,arguments);var n=A(a,t)/1e3;return L(e==null?void 0:e.roundingMethod)(n)}function Ae(a,t){p(2,arguments);var e=v(a),n=v(t),s=$(e,n),l=Math.abs(Se(e,n));e.setFullYear(1584),n.setFullYear(1584);var r=$(e,n)===-s,i=s*(l-Number(r));return i===0?0:i}function Le(a){p(1,arguments);var t=v(a.start),e=v(a.end);if(isNaN(t.getTime()))throw new RangeError("Start Date is invalid");if(isNaN(e.getTime()))throw new RangeError("End Date is invalid");var n={};n.years=Math.abs(Ae(e,t));var s=$(e,t),l=S(t,{years:s*n.years});n.months=Math.abs(Ye(e,l));var r=S(l,{months:s*n.months});n.days=Math.abs(ke(e,r));var i=S(r,{days:s*n.days});n.hours=Math.abs(qe(e,i));var u=S(i,{hours:s*n.hours});n.minutes=Math.abs(we(e,u));var o=S(u,{minutes:s*n.minutes});return n.seconds=Math.abs(Re(e,o)),n}const Be={class:"flex-grow"},Ve={class:"text-xs font-light leading-3"},We={class:"focus:outline-none text-lg font-medium leading-5"},je=C({__name:"CalendarEvent",props:{start:{},end:{},title:{},description:{},tag:{}},setup(a){const t=a,e=T(()=>{if(!t.start&&!t.end)return"Whole day";if(t.start&&!t.end)return w(t.start,"H:mm");if(t.start&&t.end)return`${w(t.start,"H:mm")} - ${w(t.end,"H:mm")}`});return(n,s)=>(b(),k("div",{class:ee(("mergeClasses"in n?n.mergeClasses:c(G))("border-b","last-of-type:border-b-0","p-2","border-base-300","border-dashed","cursor-pointer","flex","items-center"))},[I("div",Be,[I("p",Ve,x(c(e)),1),I("p",We,x(t.title),1)]),t.tag?(b(),U(me,{key:0,icon:t.tag.icon,color:t.tag.color},null,8,["icon","color"])):Q("",!0)],2))}});function ze(a){return w(a,"yyyy-MM-dd")}function Pe(a,t){return Le({start:a,end:t})}function Xe(a){return ye(a,"yyyy-MM-dd",new Date)}function Ge(a,t){const e=Xe(a);return t[0]&&e.setHours(t[0]),t[1]&&e.setMinutes(t[1]),e}function Ze(a,t){let e=Ce(a,t[0]??0);return e=Fe(e,t[1]??0),e}const Je={class:"grid grid-cols-2 gap-2"},Ke=C({__name:"DurationPicker",props:{hours:{},minutes:{},labelClass:{}},emits:["update:hours","update:minutes"],setup(a,{emit:t}){const e=a,n=[...Array(24)].map((u,o)=>({text:("00"+o).slice(-2),value:o})),s=[...Array(12)].map((u,o)=>({text:("00"+5*o).slice(-2),value:5*o})),l=T(()=>(e.hours===void 0?"--":("00"+e.hours).slice(-2))+":"+(e.minutes===void 0?"--":("00"+e.minutes).slice(-2))),r=u=>t("update:hours",u),i=u=>t("update:minutes",u);return(u,o)=>(b(),U(Z,{"label-class":e.labelClass},{label:M(()=>[I("span",null,x(c(l)),1)]),content:M(()=>[I("div",Je,[g(O,{elements:c(n),selected:e.hours,onSelect:r},null,8,["elements","selected"]),g(O,{elements:c(s),selected:e.minutes,onSelect:i},null,8,["elements","selected"])])]),_:1},8,["label-class"]))}}),Qe=C({__name:"DurationField",props:{label:{},clearable:{type:Boolean},icon:{},hours:{},minutes:{},required:{type:Boolean}},emits:["clear","update:hours","update:minutes"],setup(a,{emit:t}){const e=a,n=()=>t("clear"),s=o=>t("update:hours",o),l=o=>t("update:minutes",o),r=T(()=>(e.hours===void 0?"--":("00"+e.hours).slice(-2))+":"+(e.minutes===void 0?"--":("00"+e.minutes).slice(-2))),i=new RegExp("[0-9]{2}:[0-9]{2}"),u=e.required?[o=>i.test(o)]:[];return(o,h)=>(b(),U(K,{icon:e.icon,clearable:e.clearable,label:e.label,value:c(r),onClear:n,rules:c(u)},{input:M(({inputClass:_})=>[g(Ke,{hours:e.hours,minutes:e.minutes,"label-class":_,class:"flex-shrink w-full","onUpdate:hours":s,"onUpdate:minutes":l},null,8,["hours","minutes","label-class"])]),_:1},8,["icon","clearable","label","value","rules"]))}}),et={class:"grid grid-cols-2 gap-2"},tt=C({__name:"TimePicker",props:{hours:{},minutes:{},labelClass:{}},emits:["update:hours","update:minutes"],setup(a,{emit:t}){const e=a,n=[...Array(24)].map((u,o)=>({text:("00"+o).slice(-2),value:o})),s=[...Array(12)].map((u,o)=>({text:("00"+5*o).slice(-2),value:5*o})),l=T(()=>(e.hours===void 0?"--":("00"+e.hours).slice(-2))+":"+(e.minutes===void 0?"--":("00"+e.minutes).slice(-2))),r=u=>t("update:hours",u),i=u=>t("update:minutes",u);return(u,o)=>(b(),U(Z,{"label-class":e.labelClass},{label:M(()=>[I("span",null,x(c(l)),1)]),content:M(()=>[I("div",et,[g(O,{elements:c(n),selected:e.hours,onSelect:r},null,8,["elements","selected"]),g(O,{elements:c(s),selected:e.minutes,onSelect:i},null,8,["elements","selected"])])]),_:1},8,["label-class"]))}}),nt=C({__name:"TimeField",props:{label:{},clearable:{type:Boolean},icon:{},hours:{},minutes:{},required:{type:Boolean}},emits:["clear","update:hours","update:minutes"],setup(a,{emit:t}){const e=a,n=()=>t("clear"),s=o=>t("update:hours",o),l=o=>t("update:minutes",o),r=T(()=>(e.hours===void 0?"--":("00"+e.hours).slice(-2))+":"+(e.minutes===void 0?"--":("00"+e.minutes).slice(-2))),i=new RegExp("[0-9]{2}:[0-9]{2}"),u=e.required?[o=>i.test(o)]:[];return(o,h)=>(b(),U(K,{icon:e.icon,clearable:e.clearable,label:e.label,value:c(r),onClear:n,rules:c(u)},{input:M(({inputClass:_})=>[g(tt,{hours:e.hours,minutes:e.minutes,"label-class":_,class:"flex-shrink w-full","onUpdate:hours":s,"onUpdate:minutes":l},null,8,["hours","minutes","label-class"])]),_:1},8,["icon","clearable","label","value","rules"]))}}),at=C({__name:"EventForm",props:{title:{},date:{},time:{},duration:{},frequency:{},tagId:{}},emits:["update:title","update:date","update:time","update:duration","update:frequency","update:tagId"],setup(a,{expose:t,emit:e}){const n=a,s=R(),l=E(null),r=Object.entries(Y).map(([m,f])=>({text:m,value:f})),i=m=>e("update:title",m),u=m=>e("update:date",m),o=m=>e("update:time",m),h=m=>e("update:duration",m),_=m=>e("update:frequency",m),N=m=>e("update:tagId",m);return t({validate:()=>{var m;return(m=l.value)==null?void 0:m.validate()}}),(m,f)=>(b(),U(Me,{ref_key:"form",ref:l},{default:M(()=>[g(z,{label:"Event Name",placeholder:"Enter name...",value:n.title,icon:c(te),"onUpdate:value":i,rules:[d=>!!d]},null,8,["value","icon","rules"]),g(z,{type:"date",label:"Event Date",placeholder:"Enter date...",value:m.date,icon:c(ne),"onUpdate:value":u,rules:[d=>!!d]},null,8,["value","icon","rules"]),g(nt,{label:"Event Time",icon:c(ae),hours:n.time[0],minutes:n.time[1],"onUpdate:hours":f[0]||(f[0]=d=>o([d,n.time[1]])),"onUpdate:minutes":f[1]||(f[1]=d=>o([n.time[0],d])),required:""},null,8,["icon","hours","minutes"]),g(Qe,{label:"Event Duration",icon:c(se),hours:n.duration[0],minutes:n.duration[1],"onUpdate:hours":f[2]||(f[2]=d=>h([d,n.duration[1]])),"onUpdate:minutes":f[3]||(f[3]=d=>h([n.duration[0],d])),required:""},null,8,["icon","hours","minutes"]),g(ve,{label:"Frequency",icon:c(re),options:c(r),value:m.frequency,"onUpdate:value":_,rules:[d=>!!d]},null,8,["icon","options","value","rules"]),g(De,{tags:c(s).tagArray,selected:n.tagId,"onUpdate:selected":N,clearable:""},null,8,["tags","selected"])]),_:1},512))}}),st=C({__name:"EditEvent",props:{event:{}},emits:["close"],setup(a,{emit:t}){const e=a,n=R(),s=E(null),l=T(()=>!!e.event),r=E(""),i=E(""),u=E([void 0,void 0]),o=E([1,0]),h=E(Y.Once),_=E(""),N=()=>t("close"),q=()=>{var d;if(!e.event||!((d=s.value)!=null&&d.validate()))return;const f=Ge(i.value,u.value);n.editEvent(e.event.id,{title:r.value,frequency:h.value,start:f,end:Ze(f,o.value),tagId:_.value}),N()},m=()=>{e.event&&(n.removeEvent(e.event.id),N())};return oe(()=>{if(e.event)if(r.value=e.event.title,i.value=ze(e.event.start),u.value=[e.event.start.getHours(),e.event.start.getMinutes()],h.value=e.event.frequency,_.value=e.event.tagId,e.event.end){const f=Pe(e.event.start,e.event.end);o.value=[f.hours,f.minutes]}else o.value=[0,0];else r.value="",i.value="",u.value=[void 0,void 0],o.value=[1,0],h.value=Y.Once,_.value=""}),(f,d)=>{const B=le;return b(),U(be,{"is-opened":c(l),onClose:N},{title:M(()=>{var y;return[H("Update event '"+x((y=e.event)==null?void 0:y.title)+"'",1)]}),default:M(()=>[g(at,{title:c(r),"onUpdate:title":d[0]||(d[0]=y=>F(r)?r.value=y:null),date:c(i),"onUpdate:date":d[1]||(d[1]=y=>F(i)?i.value=y:null),time:c(u),"onUpdate:time":d[2]||(d[2]=y=>F(u)?u.value=y:null),duration:c(o),"onUpdate:duration":d[3]||(d[3]=y=>F(o)?o.value=y:null),frequency:c(h),"onUpdate:frequency":d[4]||(d[4]=y=>F(h)?h.value=y:null),"tag-id":c(_),"onUpdate:tagId":d[5]||(d[5]=y=>F(_)?_.value=y:null),ref_key:"form",ref:s},null,8,["title","date","time","duration","frequency","tag-id"])]),actions:M(()=>[g(B,{class:"btn-error ml-2",onClick:m},{default:M(()=>[H("Delete")]),_:1}),g(B,{class:"btn-success ml-2",onClick:q},{default:M(()=>[H("Save")]),_:1})]),_:1},8,["is-opened"])}}}),rt={class:"menu"},ot=I("div",{class:"text-center font-light py-4"},"No event for this day...",-1),ft=C({__name:"CalendarEvents",props:{day:{},tagFilter:{}},setup(a){const t=a,e=R(),n=E(null),s=T(()=>de(e.getEventsOfDay(t.day)).chain().filter(r=>!t.tagFilter||r.tagId===t.tagFilter).sortBy([r=>r.start.getHours(),r=>r.start.getMinutes()]).map(r=>({event:r,tag:e.tags.get(r.tagId)})).value()),l=r=>n.value=r;return(r,i)=>(b(),k("div",null,[c(s).length>0?(b(),k(V,{key:0},[I("ul",rt,[(b(!0),k(V,null,ue(c(s),({event:u,tag:o})=>(b(),k("li",{key:"event-"+u.id},[g(je,ie(u,{tag:o,onClick:h=>l(u),class:("mergeClasses"in r?r.mergeClasses:c(G))("px-6","rounded-box")}),null,16,["tag","onClick","class"])]))),128))]),g(st,{event:c(n),onClose:i[0]||(i[0]=()=>l(null))},null,8,["event"])],64)):ce(r.$slots,"no-event",{key:1},()=>[ot])]))}});export{at as _,Ze as a,Ee as b,ft as c,ze as f,Ge as p};
