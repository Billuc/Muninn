import{g as H,l as x,o as T,c as F,a as q,t as R,h as i,q as A,M as ne,n as ae,m as K,x as g,w as I,b as y,H as re,Q as se,R as oe,S as le,T as ue,L as ie,d as U,z as b,K as Q,F as W,r as de,U as ve,y as ce,v as fe,J as me}from"./entry.3531927a.js";import{_ as ge,a as pe}from"./SelectField.vue.66698915.js";import{r as p,t as m,a as C,_ as ye,s as z,b as j,c as Me,m as he,d as _e,f as w,p as G}from"./index.f3feb017.js";import{a as S,b as De,c as X}from"./InputField.vue.934568d5.js";import{e as be,u as L,F as O}from"./eventStore.743c1aed.js";import{a as Ie}from"./index.6e1b1773.js";import{_ as Ee}from"./FABButton.vue.f87f945e.js";import{_ as Ce}from"./TagSelecter.vue.155c98a7.js";function Te(n,t){p(2,arguments);var e=m(n),a=C(t);if(isNaN(a))return new Date(NaN);if(!a)return e;var r=e.getDate(),o=new Date(e.getTime());o.setMonth(e.getMonth()+a+1,0);var s=o.getDate();return r>=s?o:(e.setFullYear(o.getFullYear(),o.getMonth(),r),e)}function k(n,t){if(p(2,arguments),!t||ye(t)!=="object")return new Date(NaN);var e=t.years?C(t.years):0,a=t.months?C(t.months):0,r=t.weeks?C(t.weeks):0,o=t.days?C(t.days):0,s=t.hours?C(t.hours):0,l=t.minutes?C(t.minutes):0,d=t.seconds?C(t.seconds):0,c=m(n),M=a||e?Te(c,a+e*12):c,D=o||r?Ie(M,o+r*7):M,E=l+s*60,N=d+E*60,u=N*1e3,f=new Date(D.getTime()+u);return f}var Ne=864e5;function Fe(n,t){p(2,arguments);var e=z(n),a=z(t),r=e.getTime()-j(e),o=a.getTime()-j(a);return Math.round((r-o)/Ne)}var $e=6e4;function Z(n,t){p(2,arguments);var e=C(t);return Me(n,e*$e)}function $(n,t){p(2,arguments);var e=m(n),a=m(t),r=e.getTime()-a.getTime();return r<0?-1:r>0?1:r}function ke(n,t){p(2,arguments);var e=m(n),a=m(t),r=e.getFullYear()-a.getFullYear(),o=e.getMonth()-a.getMonth();return r*12+o}function qe(n,t){p(2,arguments);var e=m(n),a=m(t);return e.getFullYear()-a.getFullYear()}function P(n,t){var e=n.getFullYear()-t.getFullYear()||n.getMonth()-t.getMonth()||n.getDate()-t.getDate()||n.getHours()-t.getHours()||n.getMinutes()-t.getMinutes()||n.getSeconds()-t.getSeconds()||n.getMilliseconds()-t.getMilliseconds();return e<0?-1:e>0?1:e}function Ue(n,t){p(2,arguments);var e=m(n),a=m(t),r=P(e,a),o=Math.abs(Fe(e,a));e.setDate(e.getDate()-r*o);var s=+(P(e,a)===-r),l=r*(o-s);return l===0?0:l}function B(n,t){return p(2,arguments),m(n).getTime()-m(t).getTime()}var J={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(t){return t<0?Math.ceil(t):Math.floor(t)}},we="trunc";function V(n){return n?J[n]:J[we]}function Oe(n,t,e){p(2,arguments);var a=B(n,t)/he;return V(e==null?void 0:e.roundingMethod)(a)}function He(n,t,e){p(2,arguments);var a=B(n,t)/_e;return V(e==null?void 0:e.roundingMethod)(a)}function Se(n){p(1,arguments);var t=m(n),e=t.getMonth();return t.setFullYear(t.getFullYear(),e+1,0),t.setHours(23,59,59,999),t}function Ye(n){p(1,arguments);var t=m(n);return be(t).getTime()===Se(t).getTime()}function Le(n,t){p(2,arguments);var e=m(n),a=m(t),r=$(e,a),o=Math.abs(ke(e,a)),s;if(o<1)s=0;else{e.getMonth()===1&&e.getDate()>27&&e.setDate(30),e.setMonth(e.getMonth()-r*o);var l=$(e,a)===-r;Ye(m(n))&&o===1&&$(n,a)===1&&(l=!1),s=r*(o-Number(l))}return s===0?0:s}function Re(n,t,e){p(2,arguments);var a=B(n,t)/1e3;return V(e==null?void 0:e.roundingMethod)(a)}function xe(n,t){p(2,arguments);var e=m(n),a=m(t),r=$(e,a),o=Math.abs(qe(e,a));e.setFullYear(1584),a.setFullYear(1584);var s=$(e,a)===-r,l=r*(o-Number(s));return l===0?0:l}function Ae(n){p(1,arguments);var t=m(n.start),e=m(n.end);if(isNaN(t.getTime()))throw new RangeError("Start Date is invalid");if(isNaN(e.getTime()))throw new RangeError("End Date is invalid");var a={};a.years=Math.abs(xe(e,t));var r=$(e,t),o=k(t,{years:r*a.years});a.months=Math.abs(Le(e,o));var s=k(o,{months:r*a.months});a.days=Math.abs(Ue(e,s));var l=k(s,{days:r*a.days});a.hours=Math.abs(Oe(e,l));var d=k(l,{hours:r*a.hours});a.minutes=Math.abs(He(e,d));var c=k(d,{minutes:r*a.minutes});return a.seconds=Math.abs(Re(e,c)),a}const Be={class:"flex-grow"},Ve={class:"text-xs font-light leading-3"},We={class:"focus:outline-none text-lg font-medium leading-5"},ze=H({__name:"CalendarEvent",props:{start:{},end:{},title:{},description:{},tag:{}},setup(n){const t=n,e=x(()=>{if(!t.start&&!t.end)return"Whole day";if(t.start&&!t.end)return w(t.start,"H:mm");if(t.start&&t.end)return`${w(t.start,"H:mm")} - ${w(t.end,"H:mm")}`});return(a,r)=>(T(),F("div",{class:ae(("mergeClasses"in a?a.mergeClasses:i(K))("border-b","last-of-type:border-b-0","p-2","border-base-300","border-dashed","cursor-pointer","flex","items-center"))},[q("div",Be,[q("p",Ve,R(i(e)),1),q("p",We,R(t.title),1)]),t.tag?(T(),A(ge,{key:0,icon:t.tag.icon,color:t.tag.color},null,8,["icon","color"])):ne("",!0)],2))}});function je(n){return w(n,"yyyy-MM-dd")}function Pe(n){return w(n,"HH:mm")}function Je(n,t){var a,r;const e=Ae({start:n,end:t});return`${("0"+((a=e.hours)==null?void 0:a.toString())).slice(-2)}:${("0"+((r=e.minutes)==null?void 0:r.toString())).slice(-2)}`}function Y(n,t){return G(`${n}T${t}`,"yyyy-MM-dd'T'HH:mm",new Date)}function ee(n){const t=G(n,"HH:mm",new Date);return 60*t.getHours()+t.getMinutes()}const te=H({__name:"EventForm",props:{title:{},date:{},time:{},duration:{},frequency:{},tagId:{}},emits:["update:title","update:date","update:time","update:duration","update:frequency","update:tagId"],setup(n,{expose:t,emit:e}){const a=n,r=L(),o=g(null),s=Object.entries(O).map(([u,f])=>({text:u,value:f})),l=u=>e("update:title",u),d=u=>e("update:date",u),c=u=>e("update:time",u),M=u=>e("update:duration",u),D=u=>e("update:frequency",u),E=u=>e("update:tagId",u);return t({validate:()=>{var u;return(u=o.value)==null?void 0:u.validate()}}),(u,f)=>(T(),A(De,{ref_key:"form",ref:o},{default:I(()=>[y(S,{label:"Event Name",placeholder:"Enter name...",value:a.title,icon:i(re),"onUpdate:value":l,rules:[v=>!!v]},null,8,["value","icon","rules"]),y(S,{type:"date",label:"Event Date",placeholder:"Enter name...",value:u.date,icon:i(se),"onUpdate:value":d,rules:[v=>!!v]},null,8,["value","icon","rules"]),y(S,{type:"time",label:"Event Time",placeholder:"Enter name...",value:u.time,icon:i(oe),"onUpdate:value":c,rules:[v=>!!v]},null,8,["value","icon","rules"]),y(S,{type:"time",label:"Event Duration",placeholder:"Enter name...",value:u.duration,icon:i(le),"onUpdate:value":M},null,8,["value","icon"]),y(pe,{label:"Frequency",icon:i(ue),options:i(s),value:u.frequency,"onUpdate:value":D,rules:[v=>!!v]},null,8,["icon","options","value","rules"]),y(Ce,{tags:i(r).tagArray,selected:a.tagId,"onUpdate:selected":E,clearable:""},null,8,["tags","selected"])]),_:1},512))}}),Ke=H({__name:"EditEvent",props:{event:{}},emits:["close"],setup(n,{emit:t}){const e=n,a=L(),r=g(null),o=x(()=>!!e.event),s=g(""),l=g(""),d=g(""),c=g("01:00"),M=g(O.Once),D=g(-1),E=()=>t("close"),N=()=>{var f;e.event&&(f=r.value)!=null&&f.validate()&&(a.editEvent(e.event.id,{title:s.value,frequency:M.value,start:Y(l.value,d.value),end:Z(Y(l.value,d.value),ee(c.value)),tagId:D.value}),E())},u=()=>{e.event&&(a.removeEvent(e.event.id),E())};return ie(()=>{e.event?(s.value=e.event.title,l.value=je(e.event.start),d.value=Pe(e.event.start),c.value=e.event.end?Je(e.event.start,e.event.end):"00:00",M.value=e.event.frequency,D.value=e.event.tagId):(s.value="",l.value="",d.value="",c.value="01:00",M.value=O.Once,D.value=-1)}),(f,v)=>{const h=Q;return T(),A(X,{"is-opened":i(o),onClose:E},{title:I(()=>{var _;return[U("Update event '"+R((_=e.event)==null?void 0:_.title)+"'",1)]}),default:I(()=>[y(te,{title:i(s),"onUpdate:title":v[0]||(v[0]=_=>b(s)?s.value=_:null),date:i(l),"onUpdate:date":v[1]||(v[1]=_=>b(l)?l.value=_:null),time:i(d),"onUpdate:time":v[2]||(v[2]=_=>b(d)?d.value=_:null),duration:i(c),"onUpdate:duration":v[3]||(v[3]=_=>b(c)?c.value=_:null),frequency:i(M),"onUpdate:frequency":v[4]||(v[4]=_=>b(M)?M.value=_:null),"tag-id":i(D),"onUpdate:tagId":v[5]||(v[5]=_=>b(D)?D.value=_:null),ref_key:"form",ref:r},null,8,["title","date","time","duration","frequency","tag-id"])]),actions:I(()=>[y(h,{class:"btn-error ml-2",onClick:u},{default:I(()=>[U("Delete")]),_:1}),y(h,{class:"btn-success ml-2",onClick:N},{default:I(()=>[U("Save")]),_:1})]),_:1},8,["is-opened"])}}}),Qe={class:"menu"},Ge=q("div",{class:"text-center font-light py-4"},"No event for this day...",-1),ot=H({__name:"CalendarEvents",props:{day:{},tagFilter:{}},setup(n){const t=n,e=L(),a=g(null),r=x(()=>fe(e.getEventsOfDay(t.day)).chain().filter(s=>(t.tagFilter??-1)<0||s.tagId===t.tagFilter).sortBy([s=>s.start.getHours(),s=>s.start.getMinutes()]).map(s=>({event:s,tag:e.tags.get(s.tagId)})).value()),o=s=>a.value=s;return(s,l)=>(T(),F("div",null,[i(r).length>0?(T(),F(W,{key:0},[q("ul",Qe,[(T(!0),F(W,null,de(i(r),({event:d,tag:c})=>(T(),F("li",{key:"event-"+d.id},[y(ze,ve(d,{tag:c,onClick:M=>o(d),class:("mergeClasses"in s?s.mergeClasses:i(K))("px-6","rounded-box")}),null,16,["tag","onClick","class"])]))),128))]),y(Ke,{event:i(a),onClose:l[0]||(l[0]=()=>o(null))},null,8,["event"])],64)):ce(s.$slots,"no-event",{key:1},()=>[Ge])]))}}),lt=H({__name:"CreateEvent",setup(n){const t=L(),e=g(!1),a=g(null),r=g(""),o=g(""),s=g(""),l=g("01:00"),d=g(O.Once),c=g(-1),M=()=>e.value=!0,D=()=>e.value=!1,E=()=>{var u;(u=a.value)!=null&&u.validate()&&(t.newEvent({title:r.value,frequency:d.value,start:Y(o.value,s.value),end:Z(Y(o.value,s.value),ee(l.value)),tagId:c.value}),D(),N())},N=()=>{r.value="",o.value="",s.value="",l.value="01:00",d.value=O.Once,c.value=-1};return(u,f)=>{const v=Q;return T(),F("div",null,[y(Ee,{icon:i(me),class:"-bottom-4 right-4",onClick:M},null,8,["icon"]),y(X,{"is-opened":i(e),onClose:D},{title:I(()=>[U("Create a new event")]),default:I(()=>[y(te,{title:i(r),"onUpdate:title":f[0]||(f[0]=h=>b(r)?r.value=h:null),date:i(o),"onUpdate:date":f[1]||(f[1]=h=>b(o)?o.value=h:null),time:i(s),"onUpdate:time":f[2]||(f[2]=h=>b(s)?s.value=h:null),duration:i(l),"onUpdate:duration":f[3]||(f[3]=h=>b(l)?l.value=h:null),frequency:i(d),"onUpdate:frequency":f[4]||(f[4]=h=>b(d)?d.value=h:null),"tag-id":i(c),"onUpdate:tagId":f[5]||(f[5]=h=>b(c)?c.value=h:null),ref_key:"form",ref:a},null,8,["title","date","time","duration","frequency","tag-id"])]),actions:I(()=>[y(v,{class:"btn-success",onClick:E},{default:I(()=>[U("Create")]),_:1})]),_:1},8,["is-opened"])])}}});export{ot as _,Te as a,lt as b};
